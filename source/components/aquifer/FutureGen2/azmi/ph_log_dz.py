'''
output: ph_log_dz
prediction score: 0.8120599294173368
Forward Pass
---------------------------------------------------------------
iter  parent  var  knot  mse       terms  gcv    rsq    grsq
---------------------------------------------------------------
0     -       -    -     2.601316  1      2.602  0.000  0.000
1     0       9    4183  1.477139  3      1.480  0.432  0.431
2     0       10   5367  1.105219  5      1.110  0.575  0.574
3     3       9    3479  0.799947  7      0.805  0.692  0.691
4     3       9    4637  0.719645  9      0.725  0.723  0.721
5     0       0    -1    0.673762  10     0.680  0.741  0.739
6     1       10   4879  0.653407  12     0.660  0.749  0.746
7     3       10   3906  0.637570  14     0.646  0.755  0.752
8     9       9    2584  0.620979  16     0.630  0.761  0.758
9     4       9    1804  0.602197  18     0.612  0.769  0.765
10    3       9    5372  0.581221  20     0.592  0.777  0.773
11    1       9    87    0.553029  22     0.564  0.787  0.783
12    9       3    -1    0.540885  23     0.552  0.792  0.788
13    0       4    -1    0.529931  24     0.542  0.796  0.792
14    9       10   731   0.519642  26     0.532  0.800  0.796
15    1       10   1831  0.509771  28     0.523  0.804  0.799
16    23      9    2954  0.501501  30     0.515  0.807  0.802
17    23      9    4883  0.494452  32     0.509  0.810  0.804
18    23      10   1148  0.488862  34     0.504  0.812  0.806
19    3       3    -1    0.483677  35     0.499  0.814  0.808
20    0       8    -1    0.480133  36     0.496  0.815  0.809
21    35      9    5187  0.476749  38     0.494  0.817  0.810
22    3       9    2797  0.474126  40     0.492  0.818  0.811
23    2       2    -1    0.471451  41     0.490  0.819  0.812
24    2       3    -1    0.468990  42     0.487  0.820  0.813
---------------------------------------------------------------
Stopping Condition 2: Improvement below threshold

Pruning Pass
----------------------------------------------
iter  bf  terms  mse   gcv    rsq     grsq
----------------------------------------------
0     -   42     0.47  0.488  0.820   0.813
1     26  41     0.47  0.487  0.820   0.813
2     8   40     0.47  0.487  0.820   0.813
3     6   39     0.47  0.486  0.820   0.813
4     19  38     0.47  0.486  0.820   0.813
5     28  37     0.47  0.485  0.820   0.813
6     33  36     0.47  0.485  0.820   0.814
7     25  35     0.47  0.485  0.820   0.814
8     38  34     0.47  0.484  0.820   0.814
9     14  33     0.47  0.484  0.820   0.814
10    2   32     0.47  0.483  0.820   0.814
11    20  31     0.47  0.483  0.819   0.814
12    3   30     0.47  0.483  0.819   0.814
13    12  29     0.47  0.484  0.819   0.814
14    37  28     0.47  0.486  0.818   0.813
15    36  27     0.47  0.487  0.817   0.813
16    40  26     0.48  0.489  0.816   0.812
17    35  25     0.48  0.492  0.815   0.811
18    11  24     0.48  0.495  0.814   0.810
19    30  23     0.49  0.500  0.812   0.808
20    31  22     0.49  0.504  0.810   0.806
21    29  21     0.50  0.509  0.808   0.805
22    23  20     0.51  0.517  0.805   0.801
23    24  19     0.52  0.527  0.801   0.798
24    13  18     0.52  0.530  0.799   0.796
25    10  17     0.53  0.539  0.796   0.793
26    15  16     0.54  0.549  0.792   0.789
27    32  15     0.56  0.569  0.784   0.781
28    17  14     0.58  0.585  0.778   0.775
29    5   13     0.59  0.601  0.772   0.769
30    4   12     0.61  0.617  0.765   0.763
31    16  11     0.63  0.637  0.757   0.755
32    27  10     0.64  0.644  0.755   0.753
33    1   9      0.65  0.656  0.750   0.748
34    9   8      0.67  0.673  0.743   0.742
35    39  7      0.70  0.701  0.732   0.730
36    21  6      0.72  0.725  0.723   0.721
37    22  5      0.79  0.788  0.698   0.697
38    7   4      0.95  0.955  0.634   0.633
39    18  3      1.42  1.426  0.453   0.452
40    34  2      1.76  1.761  0.324   0.323
41    41  1      2.60  2.602  -0.000  -0.000
----------------------------------------------
Selected iteration: 11

Earth Model
-------------------------------------------------------------------------
Basis Function                                      Pruned  Coefficient
-------------------------------------------------------------------------
(Intercept)                                         No      2.40788
h(log_co2_mass-2.15074)                             No      3.81243
h(2.15074-log_co2_mass)                             Yes     None
h(log_brine_mass-9.8442)                            No      -0.0775333
h(9.8442-log_brine_mass)                            No      0.675443
h(log_co2_mass-2.84309)*h(log_brine_mass-9.8442)    No      -0.107668
h(2.84309-log_co2_mass)*h(log_brine_mass-9.8442)    Yes     None
h(log_co2_mass-15.6234)*h(log_brine_mass-9.8442)    No      -0.058124
h(15.6234-log_co2_mass)*h(log_brine_mass-9.8442)    Yes     None
thick                                               No      -0.0282182
h(log_brine_mass-15.4835)*h(log_co2_mass-2.15074)   No      -0.269269
h(15.4835-log_brine_mass)*h(log_co2_mass-2.15074)   No      0.252366
h(log_brine_mass-23.3325)*h(log_brine_mass-9.8442)  No      0.0449614
h(23.3325-log_brine_mass)*h(log_brine_mass-9.8442)  No      -0.0182998
h(log_co2_mass-4.41177)*thick                       Yes     None
h(4.41177-log_co2_mass)*thick                       No      -0.00476138
h(log_co2_mass-8.90637)*h(9.8442-log_brine_mass)    No      0.141807
h(8.90637-log_co2_mass)*h(9.8442-log_brine_mass)    No      -0.0718875
h(log_co2_mass-10.1823)*h(log_brine_mass-9.8442)    No      0.0527919
h(10.1823-log_co2_mass)*h(log_brine_mass-9.8442)    Yes     None
h(log_co2_mass-17.3234)*h(log_co2_mass-2.15074)     Yes     None
h(17.3234-log_co2_mass)*h(log_co2_mass-2.15074)     No      0.0126822
log_permh*thick                                     No      -0.00359019
log_aniso                                           No      0.460947
h(log_brine_mass-18.058)*thick                      No      -0.00319311
h(18.058-log_brine_mass)*thick                      Yes     None
h(log_brine_mass-23.8498)*h(log_co2_mass-2.15074)   Yes     None
h(23.8498-log_brine_mass)*h(log_co2_mass-2.15074)   No      -0.375026
h(log_co2_mass-9.14185)*log_aniso                   Yes     None
h(9.14185-log_co2_mass)*log_aniso                   No      -0.116596
h(log_co2_mass-4.02526)*log_aniso                   No      -0.0248694
h(4.02526-log_co2_mass)*log_aniso                   No      0.16143
h(log_brine_mass-23.5256)*log_aniso                 No      0.891392
h(23.5256-log_brine_mass)*log_aniso                 Yes     None
log_permh*h(log_brine_mass-9.8442)                  No      0.0202506
time                                                No      -0.00715562
h(log_co2_mass-10.9152)*time                        No      0.000777897
h(10.9152-log_co2_mass)*time                        No      0.000780017
h(log_co2_mass-3.26538)*h(log_brine_mass-9.8442)    Yes     None
h(3.26538-log_co2_mass)*h(log_brine_mass-9.8442)    No      0.138664
por*h(2.15074-log_co2_mass)                         No      -1.61098
log_permh*h(2.15074-log_co2_mass)                   No      0.0809401
-------------------------------------------------------------------------
MSE: 0.4697, GCV: 0.4832, RSQ: 0.8194, GRSQ: 0.8143
parameters:
X[ 0 ] =  thick
X[ 1 ] =  depth
X[ 2 ] =  por
X[ 3 ] =  log_permh
X[ 4 ] =  log_aniso
X[ 5 ] =  rel_vol_frac_calcite
X[ 6 ] =  log_co2_rate
X[ 7 ] =  log_brine_rate
X[ 8 ] =  time
X[ 9 ] =  log_co2_mass
X[ 10 ] =  log_brine_mass
'''
def model(example_iterator):
    accessors = [
        lambda x: 2.407880702070785,
        lambda x: 3.8124335555198843 * max(0, x[9] - 2.1507383778095193),
        lambda x: -0.07753325160075197 * max(0, x[10] - 9.844199527105921),
        lambda x: 0.6754425897399716 * max(0, 9.844199527105921 - x[10]),
        lambda x: -0.1076676311699647 * max(0, x[9] - 2.8430891577306676) *\
            max(0, x[10] - 9.844199527105921),
        lambda x: -0.0581239697100098 * max(0, x[9] - 15.62336229824979) *\
            max(0, x[10] - 9.844199527105921),
        lambda x: -0.028218194786374218 * x[0],
        lambda x: -0.26926946479294056 * max(0, x[10] - 15.48347401073324) *\
            max(0, x[9] - 2.1507383778095193),
        lambda x: 0.2523657941990831 * max(0, 15.48347401073324 - x[10]) *\
            max(0, x[9] - 2.1507383778095193),
        lambda x: 0.04496142038608529 * max(0, x[10] - 23.33246790617466) *\
            max(0, x[10] - 9.844199527105921),
        lambda x: -0.018299779979870215 * max(0, 23.33246790617466 - x[10]) *\
            max(0, x[10] - 9.844199527105921),
        lambda x: -0.004761379155779816 * max(0, 4.411774543398808 - x[9]) * x[0],
        lambda x: 0.14180668196775398 * max(0, x[9] - 8.9063728288545) *\
            max(0, 9.844199527105921 - x[10]),
        lambda x: -0.07188751107843523 * max(0, 8.9063728288545 - x[9]) *\
            max(0, 9.844199527105921 - x[10]),
        lambda x: 0.05279189750759332 * max(0, x[9] - 10.182308745822162) *\
            max(0, x[10] - 9.844199527105921),
        lambda x: 0.012682157331733016 * max(0, 17.32335608642475 - x[9]) *\
            max(0, x[9] - 2.1507383778095193),
        lambda x: -0.0035901894686252156 * x[3] * x[0],
        lambda x: 0.46094727866159296 * x[4],
        lambda x: -0.0031931099347375924 * max(0, x[10] - 18.05798561428363) * x[0],
        lambda x: -0.3750259022082816 * max(0, 23.84980145499411 - x[10]) *\
            max(0, x[9] - 2.1507383778095193),
        lambda x: -0.11659555080827805 * max(0, 9.141848026178764 - x[9]) * x[4],
        lambda x: -0.02486942931326583 * max(0, x[9] - 4.025262520306121) * x[4],
        lambda x: 0.16143026493893822 * max(0, 4.025262520306121 - x[9]) * x[4],
        lambda x: 0.8913921004366192 * max(0, x[10] - 23.525647875721116) * x[4],
        lambda x: 0.020250583428469804 * x[3] * max(0, x[10] - 9.844199527105921),
        lambda x: -0.007155622193540795 * x[8],
        lambda x: 0.0007778970530306628 * max(0, x[9] - 10.915188516500681) * x[8],
        lambda x: 0.0007800171015718282 * max(0, 10.915188516500681 - x[9]) * x[8],
        lambda x: 0.13866442141488938 * max(0, 3.2653803104696713 - x[9]) *\
            max(0, x[10] - 9.844199527105921),
        lambda x: -1.610983666834811 * x[2] * max(0, 2.1507383778095193 - x[9]),
        lambda x: 0.08094013453781203 * x[3] * max(0, 2.1507383778095193 - x[9])]
    for x in example_iterator:
        yield sum(accessor(x) for accessor in accessors)
