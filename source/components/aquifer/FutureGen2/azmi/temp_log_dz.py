'''
output: temp_log_dz
prediction score: 0.8609503590185288
Forward Pass
---------------------------------------------------------------
iter  parent  var  knot  mse       terms  gcv    rsq    grsq
---------------------------------------------------------------
0     -       -    -     2.623620  1      2.625  0.000  0.000
1     0       9    2784  1.670167  3      1.674  0.363  0.362
2     2       10   3796  0.811231  5      0.815  0.691  0.690
3     2       8    -1    0.743004  6      0.747  0.717  0.715
4     0       0    -1    0.677910  7      0.682  0.742  0.740
5     2       10   2645  0.643039  9      0.648  0.755  0.753
6     2       10   4235  0.592812  11     0.599  0.774  0.772
7     6       9    3690  0.557527  13     0.564  0.787  0.785
8     2       10   3366  0.538517  15     0.546  0.795  0.792
9     2       9    5036  0.524964  17     0.533  0.800  0.797
10    2       10   4804  0.512267  19     0.521  0.805  0.801
11    1       3    -1    0.501449  20     0.511  0.809  0.805
12    0       8    -1    0.490761  21     0.500  0.813  0.809
13    20      9    4715  0.466404  23     0.476  0.822  0.819
14    20      10   2126  0.447717  25     0.458  0.829  0.826
15    1       2    -1    0.440835  26     0.451  0.832  0.828
16    0       10   4205  0.435399  28     0.447  0.834  0.830
17    26      9    2936  0.408702  30     0.420  0.844  0.840
18    26      9    3198  0.399347  32     0.411  0.848  0.843
19    2       9    2246  0.393184  34     0.406  0.850  0.845
20    20      9    1580  0.385896  36     0.399  0.853  0.848
21    20      9    4631  0.378997  38     0.392  0.856  0.850
22    0       4    -1    0.373942  39     0.388  0.857  0.852
23    20      8    -1    0.370141  40     0.384  0.859  0.854
24    6       10   292   0.366439  42     0.381  0.860  0.855
25    38      10   1908  0.364255  44     0.379  0.861  0.855
---------------------------------------------------------------
Stopping Condition 2: Improvement below threshold

Pruning Pass
----------------------------------------------
iter  bf  terms  mse   gcv    rsq     grsq
----------------------------------------------
0     -   44     0.36  0.379  0.861   0.855
1     29  43     0.36  0.379  0.861   0.856
2     34  42     0.36  0.379  0.861   0.856
3     10  41     0.36  0.378  0.861   0.856
4     36  40     0.36  0.378  0.861   0.856
5     32  39     0.36  0.378  0.861   0.856
6     7   38     0.36  0.377  0.861   0.856
7     13  37     0.36  0.377  0.861   0.856
8     2   36     0.36  0.377  0.861   0.856
9     12  35     0.36  0.376  0.861   0.857
10    8   34     0.36  0.376  0.861   0.857
11    31  33     0.36  0.376  0.861   0.857
12    9   32     0.36  0.376  0.861   0.857
13    21  31     0.36  0.375  0.861   0.857
14    5   30     0.37  0.375  0.861   0.857
15    27  29     0.37  0.375  0.861   0.857
16    15  28     0.37  0.376  0.860   0.857
17    42  27     0.37  0.376  0.860   0.857
18    43  26     0.37  0.376  0.860   0.857
19    4   25     0.37  0.377  0.859   0.856
20    40  24     0.37  0.379  0.859   0.856
21    41  23     0.37  0.381  0.858   0.855
22    24  22     0.38  0.384  0.857   0.854
23    39  21     0.38  0.386  0.856   0.853
24    38  20     0.38  0.391  0.854   0.851
25    25  19     0.39  0.397  0.851   0.849
26    6   18     0.40  0.406  0.848   0.845
27    20  17     0.41  0.417  0.844   0.841
28    23  16     0.42  0.421  0.842   0.839
29    19  15     0.43  0.433  0.837   0.835
30    35  14     0.44  0.448  0.832   0.829
31    16  13     0.46  0.463  0.826   0.824
32    33  12     0.46  0.463  0.825   0.824
33    3   11     0.48  0.490  0.815   0.813
34    17  10     0.50  0.499  0.811   0.810
35    30  9      0.52  0.521  0.803   0.801
36    28  8      0.54  0.546  0.793   0.792
37    26  7      0.56  0.559  0.788   0.787
38    11  6      0.58  0.585  0.778   0.777
39    1   5      0.61  0.614  0.767   0.766
40    22  4      0.69  0.694  0.736   0.736
41    37  3      0.71  0.714  0.728   0.728
42    18  2      1.05  1.047  0.601   0.601
43    14  1      2.62  2.625  -0.000  -0.000
----------------------------------------------
Selected iteration: 14

Earth Model
-------------------------------------------------------------------------
Basis Function                                     Pruned  Coefficient
-------------------------------------------------------------------------
(Intercept)                                        No      3.00182
h(log_co2_mass-12.9604)                            No      -0.646468
h(12.9604-log_co2_mass)                            Yes     None
h(log_brine_mass-1.04788)*h(12.9604-log_co2_mass)  No      0.0285962
h(1.04788-log_brine_mass)*h(12.9604-log_co2_mass)  No      -0.026734
time*h(12.9604-log_co2_mass)                       Yes     None
thick                                              No      0.0120851
h(log_brine_mass-16.8575)*h(12.9604-log_co2_mass)  Yes     None
h(16.8575-log_brine_mass)*h(12.9604-log_co2_mass)  Yes     None
h(log_brine_mass-8.03978)*h(12.9604-log_co2_mass)  Yes     None
h(8.03978-log_brine_mass)*h(12.9604-log_co2_mass)  Yes     None
h(log_co2_mass-6.3388)*thick                       No      0.00127587
h(6.3388-log_co2_mass)*thick                       Yes     None
h(log_brine_mass-13.8732)*h(12.9604-log_co2_mass)  Yes     None
h(13.8732-log_brine_mass)*h(12.9604-log_co2_mass)  No      -0.0861193
h(log_co2_mass-8.49981)*h(12.9604-log_co2_mass)    No      0.0263211
h(8.49981-log_co2_mass)*h(12.9604-log_co2_mass)    No      -0.106681
h(log_brine_mass-9.4741)*h(12.9604-log_co2_mass)   No      -0.0654453
h(9.4741-log_brine_mass)*h(12.9604-log_co2_mass)   No      0.110238
log_permh*h(log_co2_mass-12.9604)                  No      -0.0382528
time                                               No      -0.0227297
h(log_co2_mass-8.35352)*time                       Yes     None
h(8.35352-log_co2_mass)*time                       No      0.0299848
h(log_brine_mass-11.1605)*time                     No      0.00186757
h(11.1605-log_brine_mass)*time                     No      0.000792805
por*h(log_co2_mass-12.9604)                        No      0.40459
h(log_brine_mass-10.0081)                          No      0.296881
h(10.0081-log_brine_mass)                          No      0.0252917
h(log_co2_mass-6.54515)*h(log_brine_mass-10.0081)  No      -0.0735488
h(6.54515-log_co2_mass)*h(log_brine_mass-10.0081)  Yes     None
h(log_co2_mass-11.2823)*h(log_brine_mass-10.0081)  No      0.0734916
h(11.2823-log_co2_mass)*h(log_brine_mass-10.0081)  Yes     None
h(log_co2_mass-6.4856)*h(12.9604-log_co2_mass)     Yes     None
h(6.4856-log_co2_mass)*h(12.9604-log_co2_mass)     No      0.125992
h(log_co2_mass-5.07197)*time                       Yes     None
h(5.07197-log_co2_mass)*time                       No      -0.0122242
h(log_co2_mass-10.511)*time                        Yes     None
h(10.511-log_co2_mass)*time                        No      -0.0184666
log_aniso                                          No      0.174344
time*time                                          No      0.000154591
h(log_brine_mass-23.6736)*thick                    No      -0.0091374
h(23.6736-log_brine_mass)*thick                    No      -0.000338774
h(log_brine_mass-11.1067)*log_aniso                No      -0.011274
h(11.1067-log_brine_mass)*log_aniso                No      -0.0168715
-------------------------------------------------------------------------
MSE: 0.3650, GCV: 0.3751, RSQ: 0.8609, GRSQ: 0.8571
parameters:
X[ 0 ] =  thick
X[ 1 ] =  depth
X[ 2 ] =  por
X[ 3 ] =  log_permh
X[ 4 ] =  log_aniso
X[ 5 ] =  rel_vol_frac_calcite
X[ 6 ] =  log_co2_rate
X[ 7 ] =  log_brine_rate
X[ 8 ] =  time
X[ 9 ] =  log_co2_mass
X[ 10 ] =  log_brine_mass
'''
def model(example_iterator):
    accessors = [
        lambda x: 3.0018243879562108,
        lambda x: -0.6464684216501034 * max(0, x[9] - 12.960379918897367),
        lambda x: 0.028596202075625177 * max(0, x[10] - 1.0478817664260194) *\
            max(0, 12.960379918897367 - x[9]),
        lambda x: -0.026734047120424372 * max(0, 1.0478817664260194 - x[10]) *\
            max(0, 12.960379918897367 - x[9]),
        lambda x: 0.012085104314325506 * x[0],
        lambda x: 0.001275868073200015 * max(0, x[9] - 6.338795142478062) * x[0],
        lambda x: -0.08611931062336349 * max(0, 13.873183521149063 - x[10]) *\
            max(0, 12.960379918897367 - x[9]),
        lambda x: 0.026321106975105767 * max(0, x[9] - 8.499814170405616) *\
            max(0, 12.960379918897367 - x[9]),
        lambda x: -0.10668118625995954 * max(0, 8.499814170405616 - x[9]) *\
            max(0, 12.960379918897367 - x[9]),
        lambda x: -0.06544527349976093 * max(0, x[10] - 9.474096812916) *\
            max(0, 12.960379918897367 - x[9]),
        lambda x: 0.11023848927438763 * max(0, 9.474096812916 - x[10]) *\
            max(0, 12.960379918897367 - x[9]),
        lambda x: -0.03825275602673295 * x[3] * max(0, x[9] - 12.960379918897367),
        lambda x: -0.022729703182914236 * x[8],
        lambda x: 0.029984754290509643 * max(0, 8.353519164649535 - x[9]) * x[8],
        lambda x: 0.0018675681445987358 * max(0, x[10] - 11.160473201957787) * x[8],
        lambda x: 0.0007928049742160805 * max(0, 11.160473201957787 - x[10]) * x[8],
        lambda x: 0.4045900467396112 * x[2] * max(0, x[9] - 12.960379918897367),
        lambda x: 0.2968807627296986 * max(0, x[10] - 10.00813565596101),
        lambda x: 0.025291703704166536 * max(0, 10.00813565596101 - x[10]),
        lambda x: -0.07354882562759998 * max(0, x[9] - 6.545152655376546) *\
            max(0, x[10] - 10.00813565596101),
        lambda x: 0.07349161507801535 * max(0, x[9] - 11.28232861614118) *\
            max(0, x[10] - 10.00813565596101),
        lambda x: 0.12599206989863693 * max(0, 6.485602234521565 - x[9]) *\
            max(0, 12.960379918897367 - x[9]),
        lambda x: -0.012224167130209886 * max(0, 5.071973875402641 - x[9]) * x[8],
        lambda x: -0.018466592097294475 * max(0, 10.510958901959123 - x[9]) * x[8],
        lambda x: 0.17434380748110542 * x[4],
        lambda x: 0.00015459083836955045 * x[8] * x[8],
        lambda x: -0.009137400532306585 * max(0, x[10] - 23.673615203756253) * x[0],
        lambda x: -0.0003387736977198963 * max(0, 23.673615203756253 - x[10]) * x[0],
        lambda x: -0.011274019557255608 * max(0, x[10] - 11.106717922798486) * x[4],
        lambda x: -0.0168715126546021 * max(0, 11.106717922798486 - x[10]) * x[4]]
    for x in example_iterator:
        yield sum(accessor(x) for accessor in accessors)
