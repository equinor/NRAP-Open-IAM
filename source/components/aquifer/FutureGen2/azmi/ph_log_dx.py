'''
output: ph_log_dx
prediction score: 0.9060680614619673
Forward Pass
---------------------------------------------------------------
iter  parent  var  knot  mse       terms  gcv    rsq    grsq
---------------------------------------------------------------
0     -       -    -     7.954454  1      7.957  0.000  0.000
1     0       9    2346  1.471317  3      1.475  0.815  0.815
2     2       10   4804  1.277263  5      1.282  0.839  0.839
3     0       2    -1    1.235167  6      1.241  0.845  0.844
4     0       3    -1    1.192203  7      1.199  0.850  0.849
5     5       10   2640  1.163954  9      1.173  0.854  0.853
6     1       10   4574  1.108035  11     1.119  0.861  0.859
7     2       10   1490  1.029290  13     1.041  0.871  0.869
8     6       10   4016  0.971152  15     0.984  0.878  0.876
9     0       8    -1    0.944085  16     0.958  0.881  0.880
10    15      7    825   0.922992  18     0.938  0.884  0.882
11    0       0    -1    0.905720  19     0.921  0.886  0.884
12    18      10   3096  0.880231  21     0.897  0.889  0.887
13    0       10   4790  0.861858  23     0.880  0.892  0.889
14    21      9    1381  0.837826  25     0.857  0.895  0.892
15    2       9    4439  0.785188  27     0.805  0.901  0.899
16    2       10   1278  0.771738  29     0.792  0.903  0.900
17    18      4    1958  0.760283  31     0.782  0.904  0.902
18    21      9    4637  0.748653  33     0.772  0.906  0.903
19    6       9    3354  0.735064  35     0.759  0.908  0.905
20    5       10   1081  0.727301  37     0.752  0.909  0.905
---------------------------------------------------------------
Stopping Condition 2: Improvement below threshold

Pruning Pass
----------------------------------------------
iter  bf  terms  mse   gcv    rsq     grsq
----------------------------------------------
0     -   37     0.73  0.753  0.909   0.905
1     24  36     0.73  0.752  0.909   0.906
2     4   35     0.73  0.751  0.909   0.906
3     35  34     0.73  0.751  0.909   0.906
4     27  33     0.73  0.750  0.909   0.906
5     20  32     0.73  0.749  0.909   0.906
6     14  31     0.73  0.748  0.909   0.906
7     25  30     0.73  0.748  0.909   0.906
8     13  29     0.73  0.747  0.908   0.906
9     22  28     0.73  0.747  0.908   0.906
10    11  27     0.73  0.746  0.908   0.906
11    29  26     0.73  0.746  0.908   0.906
12    16  25     0.73  0.748  0.908   0.906
13    5   24     0.73  0.751  0.908   0.906
14    33  23     0.74  0.756  0.907   0.905
15    15  22     0.75  0.761  0.906   0.904
16    34  21     0.76  0.770  0.905   0.903
17    30  20     0.77  0.780  0.904   0.902
18    18  19     0.77  0.785  0.903   0.901
19    36  18     0.78  0.798  0.901   0.900
20    17  17     0.81  0.819  0.899   0.897
21    7   16     0.83  0.843  0.896   0.894
22    28  15     0.85  0.863  0.893   0.892
23    3   14     0.87  0.878  0.891   0.890
24    6   13     0.90  0.912  0.887   0.885
25    8   12     0.94  0.946  0.882   0.881
26    23  11     1.04  1.051  0.869   0.868
27    26  10     1.08  1.086  0.865   0.864
28    21  9      1.17  1.175  0.853   0.852
29    32  8      1.17  1.175  0.853   0.852
30    12  7      1.18  1.184  0.852   0.851
31    10  6      1.20  1.205  0.849   0.849
32    31  5      1.20  1.208  0.849   0.848
33    9   4      1.35  1.352  0.831   0.830
34    19  3      1.47  1.475  0.815   0.815
35    1   2      2.46  2.465  0.691   0.690
36    2   1      7.95  7.957  -0.000  -0.000
----------------------------------------------
Selected iteration: 11

Earth Model
--------------------------------------------------------------------------
Basis Function                                       Pruned  Coefficient
--------------------------------------------------------------------------
(Intercept)                                          No      8.78221
h(log_co2_mass-12.7451)                              No      7.18858
h(12.7451-log_co2_mass)                              No      -8.14784
h(log_brine_mass-9.4741)*h(12.7451-log_co2_mass)     No      -0.0280293
h(9.4741-log_brine_mass)*h(12.7451-log_co2_mass)     Yes     None
por                                                  No      -2.28344
log_permh                                            No      0.366665
h(log_brine_mass-18.8307)*por                        No      -1.80192
h(18.8307-log_brine_mass)*por                        No      -0.346404
h(log_brine_mass-19.1399)*h(log_co2_mass-12.7451)    No      0.512611
h(19.1399-log_brine_mass)*h(log_co2_mass-12.7451)    No      -0.358461
h(log_brine_mass-22.5364)*h(12.7451-log_co2_mass)    Yes     None
h(22.5364-log_brine_mass)*h(12.7451-log_co2_mass)    No      0.298688
h(log_brine_mass-21.9376)*log_permh                  Yes     None
h(21.9376-log_brine_mass)*log_permh                  Yes     None
time                                                 No      -0.0300458
h(log_brine_rate-3.39134)*time                       No      -0.436355
h(3.39134-log_brine_rate)*time                       No      0.0112051
thick                                                No      -0.00828414
h(log_brine_mass-19.6995)*thick                      No      -0.00959227
h(19.6995-log_brine_mass)*thick                      Yes     None
h(log_brine_mass-0.0791176)                          No      -1.47224
h(0.0791176-log_brine_mass)                          Yes     None
h(log_co2_mass-4.82614)*h(log_brine_mass-0.0791176)  No      0.0497689
h(4.82614-log_co2_mass)*h(log_brine_mass-0.0791176)  Yes     None
h(log_co2_mass-5.4676)*h(12.7451-log_co2_mass)       Yes     None
h(5.4676-log_co2_mass)*h(12.7451-log_co2_mass)       No      -0.0405956
h(log_brine_mass-18.7543)*h(12.7451-log_co2_mass)    Yes     None
h(18.7543-log_brine_mass)*h(12.7451-log_co2_mass)    No      0.0592132
h(log_aniso-2.99165)*thick                           Yes     None
h(2.99165-log_aniso)*thick                           No      0.00212099
h(log_co2_mass-15.6234)*h(log_brine_mass-0.0791176)  No      -0.435837
h(15.6234-log_co2_mass)*h(log_brine_mass-0.0791176)  No      0.395305
h(log_co2_mass-15.1346)*log_permh                    No      -0.0210488
h(15.1346-log_co2_mass)*log_permh                    No      -0.0168282
h(log_brine_mass-7.74307)*por                        Yes     None
h(7.74307-log_brine_mass)*por                        No      0.721228
--------------------------------------------------------------------------
MSE: 0.7290, GCV: 0.7464, RSQ: 0.9084, GRSQ: 0.9062
parameters:
X[ 0 ] =  thick
X[ 1 ] =  depth
X[ 2 ] =  por
X[ 3 ] =  log_permh
X[ 4 ] =  log_aniso
X[ 5 ] =  rel_vol_frac_calcite
X[ 6 ] =  log_co2_rate
X[ 7 ] =  log_brine_rate
X[ 8 ] =  time
X[ 9 ] =  log_co2_mass
X[ 10 ] =  log_brine_mass
'''
def model(example_iterator):
    accessors = [
        lambda x: 8.782214900820184,
        lambda x: 7.188577557030899 * max(0, x[9] - 12.745107520499324),
        lambda x: -8.147840507800144 * max(0, 12.745107520499324 - x[9]),
        lambda x: -0.028029348962193 * max(0, x[10] - 9.474096812916) *\
            max(0, 12.745107520499324 - x[9]),
        lambda x: -2.2834415594249364 * x[2],
        lambda x: 0.36666457838191074 * x[3],
        lambda x: -1.80192420824337 * max(0, x[10] - 18.83065401429513) * x[2],
        lambda x: -0.3464035029503911 * max(0, 18.83065401429513 - x[10]) * x[2],
        lambda x: 0.5126110287928425 * max(0, x[10] - 19.139923026463258) *\
            max(0, x[9] - 12.745107520499324),
        lambda x: -0.3584607605521175 * max(0, 19.139923026463258 - x[10]) *\
            max(0, x[9] - 12.745107520499324),
        lambda x: 0.298688446882309 * max(0, 22.536443700926455 - x[10]) *\
            max(0, 12.745107520499324 - x[9]),
        lambda x: -0.030045751188914727 * x[8],
        lambda x: -0.4363553719617836 * max(0, x[7] - 3.3913360381634163) * x[8],
        lambda x: 0.011205119312464706 * max(0, 3.3913360381634163 - x[7]) * x[8],
        lambda x: -0.008284142390830418 * x[0],
        lambda x: -0.009592268220330324 * max(0, x[10] - 19.69953881231102) * x[0],
        lambda x: -1.4722392132638304 * max(0, x[10] - 0.07911757874660041),
        lambda x: 0.04976893760584611 * max(0, x[9] - 4.826143272594593) *\
            max(0, x[10] - 0.07911757874660041),
        lambda x: -0.040595647142523006 * max(0, 5.467596369362246 - x[9]) *\
            max(0, 12.745107520499324 - x[9]),
        lambda x: 0.05921324875209932 * max(0, 18.754308361109686 - x[10]) *\
            max(0, 12.745107520499324 - x[9]),
        lambda x: 0.0021209877434267277 * max(0, 2.9916536194992114 - x[4]) * x[0],
        lambda x: -0.4358371117846473 * max(0, x[9] - 15.62336229824979) *\
            max(0, x[10] - 0.07911757874660041),
        lambda x: 0.39530489832282845 * max(0, 15.62336229824979 - x[9]) *\
            max(0, x[10] - 0.07911757874660041),
        lambda x: -0.021048795045050972 * max(0, x[9] - 15.134629305397608) * x[3],
        lambda x: -0.01682815439146612 * max(0, 15.134629305397608 - x[9]) * x[3],
        lambda x: 0.7212280672367024 * max(0, 7.743066687074416 - x[10]) * x[2]]
    for x in example_iterator:
        yield sum(accessor(x) for accessor in accessors)
