'''
output: temp_log_dy
prediction score: 0.9370111177225273
Forward Pass
---------------------------------------------------------------
iter  parent  var  knot  mse       terms  gcv    rsq    grsq
---------------------------------------------------------------
0     -       -    -     8.129387  1      8.132  0.000  0.000
1     0       9    5063  3.405470  3      3.413  0.581  0.580
2     0       10   830   1.665023  5      1.672  0.795  0.794
3     3       9    3115  0.664261  7      0.668  0.918  0.918
4     0       8    -1    0.608406  8      0.613  0.925  0.925
5     1       9    4593  0.573644  10     0.579  0.929  0.929
6     1       10   446   0.543283  12     0.549  0.933  0.932
7     4       9    1265  0.522251  14     0.529  0.936  0.935
8     7       9    264   0.502922  16     0.510  0.938  0.937
9     3       10   1491  0.487853  18     0.496  0.940  0.939
10    3       3    -1    0.475188  19     0.483  0.942  0.941
11    7       9    377   0.465171  21     0.474  0.943  0.942
12    4       10   1691  0.457284  23     0.467  0.944  0.943
---------------------------------------------------------------
Stopping Condition 2: Improvement below threshold

Pruning Pass
----------------------------------------------
iter  bf  terms  mse   gcv    rsq     grsq
----------------------------------------------
0     -   23     0.46  0.467  0.944   0.943
1     7   22     0.46  0.466  0.944   0.943
2     3   21     0.46  0.466  0.944   0.943
3     11  20     0.46  0.467  0.944   0.943
4     21  19     0.46  0.469  0.943   0.942
5     19  18     0.46  0.471  0.943   0.942
6     22  17     0.47  0.475  0.942   0.942
7     2   16     0.47  0.479  0.942   0.941
8     20  15     0.48  0.482  0.941   0.941
9     16  14     0.48  0.487  0.941   0.940
10    8   13     0.49  0.496  0.940   0.939
11    14  12     0.49  0.499  0.939   0.939
12    17  11     0.50  0.508  0.938   0.938
13    4   10     0.51  0.512  0.938   0.937
14    12  9      0.52  0.523  0.936   0.936
15    5   8      0.54  0.546  0.933   0.933
16    10  7      0.57  0.577  0.929   0.929
17    18  6      0.58  0.580  0.929   0.929
18    15  5      0.65  0.649  0.921   0.920
19    13  4      0.71  0.715  0.912   0.912
20    9   3      0.88  0.884  0.892   0.891
21    6   2      3.62  3.624  0.555   0.554
22    1   1      8.13  8.132  -0.000  -0.000
----------------------------------------------
Selected iteration: 2

Earth Model
-------------------------------------------------------------------------
Basis Function                                      Pruned  Coefficient
-------------------------------------------------------------------------
(Intercept)                                         No      1.63125
h(log_co2_mass-8.22854)                             No      0.458905
h(8.22854-log_co2_mass)                             No      -0.0642029
h(log_brine_mass-10.59)                             Yes     None
h(10.59-log_brine_mass)                             No      0.1301
h(log_co2_mass-18.69)*h(log_brine_mass-10.59)       No      0.0445243
h(18.69-log_co2_mass)*h(log_brine_mass-10.59)       No      0.0106523
time                                                Yes     None
h(log_co2_mass-13.983)*h(log_co2_mass-8.22854)      No      0.0124331
h(13.983-log_co2_mass)*h(log_co2_mass-8.22854)      No      0.0976478
h(log_brine_mass-9.09807)*h(log_co2_mass-8.22854)   No      -0.0355276
h(9.09807-log_brine_mass)*h(log_co2_mass-8.22854)   No      -0.0119078
h(log_co2_mass-15.54)*h(10.59-log_brine_mass)       No      -0.0163015
h(15.54-log_co2_mass)*h(10.59-log_brine_mass)       No      -0.0181913
h(log_co2_mass-18.7311)*time                        No      -0.00607254
h(18.7311-log_co2_mass)*time                        No      -0.00200745
h(log_brine_mass-16.9543)*h(log_brine_mass-10.59)   No      0.00663026
h(16.9543-log_brine_mass)*h(log_brine_mass-10.59)   No      0.0362679
log_permh*h(log_brine_mass-10.59)                   No      -0.0267521
h(log_co2_mass-8.48307)*time                        No      0.000549866
h(8.48307-log_co2_mass)*time                        No      0.00331629
h(log_brine_mass-0.131199)*h(10.59-log_brine_mass)  No      -0.00864566
h(0.131199-log_brine_mass)*h(10.59-log_brine_mass)  No      0.373959
-------------------------------------------------------------------------
MSE: 0.4575, GCV: 0.4662, RSQ: 0.9437, GRSQ: 0.9427
parameters:
X[ 0 ] =  thick
X[ 1 ] =  depth
X[ 2 ] =  por
X[ 3 ] =  log_permh
X[ 4 ] =  log_aniso
X[ 5 ] =  rel_vol_frac_calcite
X[ 6 ] =  log_co2_rate
X[ 7 ] =  log_brine_rate
X[ 8 ] =  time
X[ 9 ] =  log_co2_mass
X[ 10 ] =  log_brine_mass
'''
def model(example_iterator):
    accessors = [
        lambda x: 1.631254695373133,
        lambda x: 0.45890487758580795 * max(0, x[9] - 8.228537129684641),
        lambda x: -0.06420292377449863 * max(0, 8.228537129684641 - x[9]),
        lambda x: 0.13010047705372316 * max(0, 10.589959868429036 - x[10]),
        lambda x: 0.04452428964982328 * max(0, x[9] - 18.689977107155332) *\
            max(0, x[10] - 10.589959868429036),
        lambda x: 0.010652327192401695 * max(0, 18.689977107155332 - x[9]) *\
            max(0, x[10] - 10.589959868429036),
        lambda x: 0.01243313205824238 * max(0, x[9] - 13.982955914141835) *\
            max(0, x[9] - 8.228537129684641),
        lambda x: 0.09764775045597161 * max(0, 13.982955914141835 - x[9]) *\
            max(0, x[9] - 8.228537129684641),
        lambda x: -0.03552758926647607 * max(0, x[10] - 9.098066123227438) *\
            max(0, x[9] - 8.228537129684641),
        lambda x: -0.011907797694128176 * max(0, 9.098066123227438 - x[10]) *\
            max(0, x[9] - 8.228537129684641),
        lambda x: -0.016301524831186694 * max(0, x[9] - 15.54001595642669) *\
            max(0, 10.589959868429036 - x[10]),
        lambda x: -0.0181913363967193 * max(0, 15.54001595642669 - x[9]) *\
            max(0, 10.589959868429036 - x[10]),
        lambda x: -0.006072544630314855 * max(0, x[9] - 18.73108709452905) * x[8],
        lambda x: -0.0020074548838834305 * max(0, 18.73108709452905 - x[9]) * x[8],
        lambda x: 0.006630260538300117 * max(0, x[10] - 16.954291143846664) *\
            max(0, x[10] - 10.589959868429036),
        lambda x: 0.03626793003385711 * max(0, 16.954291143846664 - x[10]) *\
            max(0, x[10] - 10.589959868429036),
        lambda x: -0.026752093381825742 * x[3] * max(0, x[10] - 10.589959868429036),
        lambda x: 0.0005498663788976454 * max(0, x[9] - 8.483066263588597) * x[8],
        lambda x: 0.0033162859005220896 * max(0, 8.483066263588597 - x[9]) * x[8],
        lambda x: -0.008645658976518861 * max(0, x[10] - 0.13119944834276215) *\
            max(0, 10.589959868429036 - x[10]),
        lambda x: 0.3739594818506197 * max(0, 0.13119944834276215 - x[10]) *\
            max(0, 10.589959868429036 - x[10])]
    for x in example_iterator:
        yield sum(accessor(x) for accessor in accessors)
