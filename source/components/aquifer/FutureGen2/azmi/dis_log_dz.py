'''
output: dis_log_dz
prediction score: 0.7883398210065649
Forward Pass
---------------------------------------------------------------
iter  parent  var  knot  mse       terms  gcv    rsq    grsq
---------------------------------------------------------------
0     -       -    -     1.277390  1      1.278  0.000  0.000
1     0       9    4269  0.533210  3      0.534  0.583  0.582
2     0       0    -1    0.469061  4      0.471  0.633  0.632
3     2       10   -1    0.418908  5      0.421  0.672  0.671
4     3       3    -1    0.379119  6      0.381  0.703  0.702
5     0       4    -1    0.359931  7      0.362  0.718  0.717
6     3       9    439   0.342236  9      0.345  0.732  0.730
7     0       10   2931  0.328208  11     0.331  0.743  0.741
8     10      9    1510  0.315089  13     0.319  0.753  0.751
9     0       8    -1    0.309674  14     0.314  0.758  0.755
10    1       10   882   0.304683  16     0.309  0.761  0.758
11    13      2    -1    0.300280  17     0.305  0.765  0.761
12    10      3    -1    0.297372  18     0.302  0.767  0.764
13    1       9    1548  0.295164  20     0.301  0.769  0.765
14    6       9    2915  0.290563  22     0.296  0.773  0.768
15    10      9    2793  0.288292  24     0.295  0.774  0.769
16    13      10   1858  0.286177  26     0.293  0.776  0.771
17    0       3    -1    0.284358  27     0.291  0.777  0.772
18    26      9    4269  0.278958  29     0.286  0.782  0.776
19    13      9    5298  0.277269  31     0.285  0.783  0.777
20    10      9    5206  0.275802  33     0.284  0.784  0.778
21    6       4    -1    0.274626  34     0.283  0.785  0.778
---------------------------------------------------------------
Stopping Condition 2: Improvement below threshold

Pruning Pass
----------------------------------------------
iter  bf  terms  mse   gcv    rsq     grsq
----------------------------------------------
0     -   34     0.27  0.283  0.785   0.778
1     11  33     0.27  0.283  0.785   0.778
2     22  32     0.27  0.283  0.785   0.779
3     7   31     0.27  0.283  0.785   0.779
4     4   30     0.27  0.282  0.785   0.779
5     30  29     0.28  0.282  0.785   0.779
6     18  28     0.28  0.282  0.785   0.779
7     3   27     0.28  0.283  0.784   0.779
8     6   26     0.28  0.283  0.784   0.778
9     29  25     0.28  0.284  0.783   0.778
10    24  24     0.28  0.285  0.782   0.777
11    25  23     0.28  0.285  0.781   0.777
12    28  22     0.28  0.287  0.780   0.775
13    20  21     0.28  0.290  0.777   0.773
14    19  20     0.29  0.291  0.776   0.772
15    21  19     0.29  0.292  0.775   0.771
16    23  18     0.29  0.295  0.773   0.769
17    27  17     0.29  0.298  0.770   0.767
18    14  16     0.30  0.301  0.768   0.765
19    1   15     0.30  0.303  0.766   0.763
20    17  14     0.30  0.307  0.762   0.760
21    16  13     0.31  0.311  0.759   0.757
22    13  12     0.31  0.316  0.755   0.753
23    2   11     0.32  0.325  0.748   0.746
24    8   10     0.33  0.332  0.742   0.740
25    12  9      0.35  0.349  0.729   0.727
26    9   8      0.36  0.366  0.715   0.714
27    26  7      0.38  0.385  0.700   0.698
28    33  6      0.40  0.404  0.685   0.684
29    5   5      0.49  0.497  0.613   0.611
30    31  4      0.73  0.731  0.429   0.428
31    15  3      0.75  0.748  0.416   0.414
32    10  2      0.75  0.752  0.412   0.412
33    32  1      1.28  1.278  -0.000  -0.000
----------------------------------------------
Selected iteration: 6

Earth Model
-------------------------------------------------------------------------
Basis Function                                      Pruned  Coefficient
-------------------------------------------------------------------------
(Intercept)                                         No      -1.55791
h(log_co2_mass-0.702056)                            No      0.184833
h(0.702056-log_co2_mass)                            No      6.71797
thick                                               No      -0.020236
log_brine_mass*h(0.702056-log_co2_mass)             Yes     None
log_permh*thick                                     No      -0.00295098
log_aniso                                           No      0.13711
h(log_co2_mass-1.41661)*thick                       Yes     None
h(1.41661-log_co2_mass)*thick                       No      -0.0121067
h(log_brine_mass-15.0372)                           No      0.110877
h(15.0372-log_brine_mass)                           No      4.32794
h(log_co2_mass-0.185068)*h(15.0372-log_brine_mass)  Yes     None
h(0.185068-log_co2_mass)*h(15.0372-log_brine_mass)  No      0.84449
time                                                No      -0.0114755
h(log_brine_mass-15.0225)*h(log_co2_mass-0.702056)  No      -0.00462495
h(15.0225-log_brine_mass)*h(log_co2_mass-0.702056)  No      -0.440477
por*time                                            No      0.0331612
log_permh*h(15.0372-log_brine_mass)                 No      0.0135683
h(log_co2_mass-14.7845)*h(log_co2_mass-0.702056)    Yes     None
h(14.7845-log_co2_mass)*h(log_co2_mass-0.702056)    No      -0.00680745
h(log_co2_mass-7.12083)*log_aniso                   No      -0.0165773
h(7.12083-log_co2_mass)*log_aniso                   No      -0.0407494
h(log_co2_mass-1.31549)*h(15.0372-log_brine_mass)   Yes     None
h(1.31549-log_co2_mass)*h(15.0372-log_brine_mass)   No      -0.131303
h(log_brine_mass-19.9212)*time                      No      0.00116001
h(19.9212-log_brine_mass)*time                      No      0.000298912
log_permh                                           No      -0.30684
h(log_co2_mass-0.702056)*log_permh                  No      0.0134255
h(0.702056-log_co2_mass)*log_permh                  No      0.366134
h(log_co2_mass-10.9535)*time                        No      0.000362447
h(10.9535-log_co2_mass)*time                        Yes     None
h(log_co2_mass-10.1324)*h(15.0372-log_brine_mass)   No      0.437429
h(10.1324-log_co2_mass)*h(15.0372-log_brine_mass)   No      -0.432991
log_aniso*log_aniso                                 No      0.0534958
-------------------------------------------------------------------------
MSE: 0.2752, GCV: 0.2823, RSQ: 0.7846, GRSQ: 0.7791
parameters:
X[ 0 ] =  thick
X[ 1 ] =  depth
X[ 2 ] =  por
X[ 3 ] =  log_permh
X[ 4 ] =  log_aniso
X[ 5 ] =  rel_vol_frac_calcite
X[ 6 ] =  log_co2_rate
X[ 7 ] =  log_brine_rate
X[ 8 ] =  time
X[ 9 ] =  log_co2_mass
X[ 10 ] =  log_brine_mass
'''
def model(example_iterator):
    accessors = [
        lambda x: -1.5579089634488887,
        lambda x: 0.18483271727225728 * max(0, x[9] - 0.7020562287488791),
        lambda x: 6.717966682729478 * max(0, 0.7020562287488791 - x[9]),
        lambda x: -0.02023595320192753 * x[0],
        lambda x: -0.0029509801595447582 * x[3] * x[0],
        lambda x: 0.1371103394073053 * x[4],
        lambda x: -0.012106676310422495 * max(0, 1.416605990193701 - x[9]) * x[0],
        lambda x: 0.11087709720282062 * max(0, x[10] - 15.037221326968647),
        lambda x: 4.327935903363036 * max(0, 15.037221326968647 - x[10]),
        lambda x: 0.8444900256024206 * max(0, 0.18506819833863505 - x[9]) *\
            max(0, 15.037221326968647 - x[10]),
        lambda x: -0.011475479247812703 * x[8],
        lambda x: -0.004624952353197546 * max(0, x[10] - 15.022508118179593) *\
            max(0, x[9] - 0.7020562287488791),
        lambda x: -0.440477445843119 * max(0, 15.022508118179593 - x[10]) *\
            max(0, x[9] - 0.7020562287488791),
        lambda x: 0.03316122428523863 * x[2] * x[8],
        lambda x: 0.013568258789569031 * x[3] * max(0, 15.037221326968647 - x[10]),
        lambda x: -0.006807449775634717 * max(0, 14.784520244843666 - x[9]) *\
            max(0, x[9] - 0.7020562287488791),
        lambda x: -0.016577252057739498 * max(0, x[9] - 7.120831309151044) * x[4],
        lambda x: -0.04074942954071694 * max(0, 7.120831309151044 - x[9]) * x[4],
        lambda x: -0.13130285309979503 * max(0, 1.3154900858111318 - x[9]) * \
            max(0, 15.037221326968647 - x[10]),
        lambda x: 0.0011600126302984599 * max(0, x[10] - 19.921180259080067) * x[8],
        lambda x: 0.00029891182808121364 * max(0, 19.921180259080067 - x[10]) * x[8],
        lambda x: -0.3068397943330053 * x[3],
        lambda x: 0.013425522885692768 * max(0, x[9] - 0.7020562287488791) * x[3],
        lambda x: 0.36613367358809007 * max(0, 0.7020562287488791 - x[9]) * x[3],
        lambda x: 0.0003624470442818162 * max(0, x[9] - 10.95354423167383) * x[8],
        lambda x: 0.4374290052469959 * max(0, x[9] - 10.132366500687716) *\
            max(0, 15.037221326968647 - x[10]),
        lambda x: -0.4329906051875643 * max(0, 10.132366500687716 - x[9]) *\
            max(0, 15.037221326968647 - x[10]),
        lambda x: 0.05349580675877094 * x[4] * x[4]]
    for x in example_iterator:
        yield sum(accessor(x) for accessor in accessors)
