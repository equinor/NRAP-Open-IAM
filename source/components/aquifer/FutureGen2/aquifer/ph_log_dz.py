'''
output: ph_log_dz
prediction score: 0.796932951904793
Forward Pass
---------------------------------------------------------------
iter  parent  var  knot  mse       terms  gcv    rsq    grsq
---------------------------------------------------------------
0     -       -    -     2.533211  1      2.534  0.000  0.000
1     0       9    4151  1.569744  3      1.574  0.380  0.379
2     0       10   2364  1.162682  5      1.168  0.541  0.539
3     3       9    2074  0.819015  7      0.824  0.677  0.675
4     3       9    1291  0.736935  9      0.743  0.709  0.707
5     0       0    1584  0.696253  11     0.704  0.725  0.722
6     0       3    -1    0.664852  12     0.672  0.738  0.735
7     0       4    -1    0.652260  13     0.660  0.743  0.739
8     3       7    -1    0.639231  14     0.648  0.748  0.744
9     1       7    -1    0.617030  15     0.626  0.756  0.753
10    10      9    3248  0.605985  17     0.616  0.761  0.757
11    12      9    3551  0.594155  19     0.605  0.765  0.761
12    11      3    -1    0.584914  20     0.596  0.769  0.765
13    3       9    1729  0.577555  22     0.590  0.772  0.767
14    11      9    2792  0.570245  24     0.584  0.775  0.770
15    1       9    3401  0.564160  26     0.579  0.777  0.772
16    1       8    -1    0.558482  27     0.574  0.780  0.774
17    12      10   2423  0.553888  29     0.570  0.781  0.775
18    2       2    -1    0.549692  30     0.566  0.783  0.777
19    10      9    3884  0.545543  32     0.563  0.785  0.778
20    10      9    3704  0.542314  34     0.561  0.786  0.779
21    0       2    3729  0.539377  36     0.559  0.787  0.779
22    35      9    2516  0.529169  38     0.550  0.791  0.783
23    35      10   2658  0.522095  40     0.543  0.794  0.786
24    1       10   2995  0.515021  42     0.537  0.797  0.788
25    35      9    214   0.509105  44     0.532  0.799  0.790
26    11      9    3281  0.489093  46     0.512  0.807  0.798
27    3       9    601   0.485773  48     0.510  0.808  0.799
28    3       10   2505  0.483196  50     0.508  0.809  0.800
29    2       10   -1    0.481150  51     0.506  0.810  0.800
---------------------------------------------------------------
Stopping Condition 2: Improvement below threshold

Pruning Pass
--------------------------------------------
iter  bf  terms  mse   gcv    rsq    grsq
--------------------------------------------
0     -   51     0.48  0.507  0.810  0.800
1     47  50     0.48  0.506  0.810  0.800
2     11  49     0.48  0.505  0.810  0.801
3     6   48     0.48  0.505  0.810  0.801
4     31  47     0.48  0.504  0.810  0.801
5     20  46     0.48  0.504  0.810  0.801
6     16  45     0.48  0.503  0.810  0.801
7     37  44     0.48  0.503  0.810  0.802
8     41  43     0.48  0.502  0.810  0.802
9     1   42     0.48  0.502  0.810  0.802
10    28  41     0.48  0.502  0.810  0.802
11    48  40     0.48  0.502  0.810  0.802
12    24  39     0.48  0.501  0.810  0.802
13    33  38     0.48  0.502  0.809  0.802
14    4   37     0.48  0.502  0.809  0.802
15    35  36     0.48  0.502  0.809  0.802
16    10  35     0.49  0.503  0.808  0.801
17    15  34     0.49  0.504  0.807  0.801
18    21  33     0.49  0.506  0.807  0.801
19    34  32     0.49  0.507  0.806  0.800
20    39  31     0.49  0.509  0.805  0.799
21    49  30     0.50  0.511  0.804  0.798
22    50  29     0.50  0.513  0.803  0.797
23    26  28     0.50  0.516  0.802  0.796
24    14  27     0.51  0.520  0.800  0.795
25    5   26     0.51  0.525  0.798  0.793
26    9   25     0.52  0.530  0.796  0.791
27    32  24     0.53  0.538  0.792  0.788
28    23  23     0.54  0.548  0.789  0.784
29    45  22     0.54  0.547  0.788  0.784
30    19  21     0.54  0.549  0.788  0.783
31    17  20     0.55  0.558  0.784  0.780
32    18  19     0.55  0.565  0.781  0.777
33    27  18     0.57  0.576  0.777  0.773
34    13  17     0.57  0.584  0.773  0.770
35    12  16     0.58  0.592  0.770  0.766
36    36  15     0.60  0.606  0.764  0.761
37    42  14     0.60  0.611  0.762  0.759
38    25  13     0.61  0.623  0.757  0.754
39    40  12     0.63  0.635  0.752  0.749
40    38  11     0.64  0.647  0.747  0.745
41    2   10     0.66  0.667  0.739  0.737
42    43  9      0.69  0.700  0.726  0.724
43    29  8      0.72  0.724  0.716  0.714
44    30  7      0.76  0.764  0.700  0.698
45    8   6      0.87  0.879  0.655  0.653
46    7   5      0.93  0.933  0.633  0.632
47    46  4      1.19  1.198  0.529  0.527
48    22  3      1.51  1.514  0.404  0.402
49    3   2      1.80  1.807  0.288  0.287
50    44  1      2.53  2.534  0.000  0.000
--------------------------------------------
Selected iteration: 12

Earth Model
---------------------------------------------------------------------------
Basis Function                                       Pruned  Coefficient
---------------------------------------------------------------------------
(Intercept)                                          No      -23.1803
h(log_co2_mass-1.86057)                              Yes     None
h(1.86057-log_co2_mass)                              No      4.59547
h(log_brine_mass-8.98141)                            No      -3.51599
h(8.98141-log_brine_mass)                            No      -0.0196661
h(log_co2_mass-1.98267)*h(log_brine_mass-8.98141)    No      0.223318
h(1.98267-log_co2_mass)*h(log_brine_mass-8.98141)    Yes     None
h(log_co2_mass-15.473)*h(log_brine_mass-8.98141)     No      -0.268692
h(15.473-log_co2_mass)*h(log_brine_mass-8.98141)     No      0.229427
h(thick-89.8134)                                     No      -9.62979
h(89.8134-thick)                                     No      0.0539808
log_permh                                            Yes     None
log_aniso                                            No      0.36079
log_brine_rate*h(log_brine_mass-8.98141)             No      0.0313835
log_brine_rate*h(log_co2_mass-1.86057)               No      -0.0221462
h(log_co2_mass-2.63466)*h(89.8134-thick)             No      0.012866
h(2.63466-log_co2_mass)*h(89.8134-thick)             Yes     None
h(log_co2_mass-4.62309)*log_aniso                    No      -0.0198707
h(4.62309-log_co2_mass)*log_aniso                    No      -0.0894507
log_permh*log_permh                                  No      -0.153814
h(log_co2_mass-8.02219)*h(log_brine_mass-8.98141)    Yes     None
h(8.02219-log_co2_mass)*h(log_brine_mass-8.98141)    No      0.0129293
h(log_co2_mass-1.90079)*log_permh                    No      4.34429
h(1.90079-log_co2_mass)*log_permh                    No      -4.02373
h(log_co2_mass-17.7475)*h(log_co2_mass-1.86057)      Yes     None
h(17.7475-log_co2_mass)*h(log_co2_mass-1.86057)      No      0.0126078
time*h(log_co2_mass-1.86057)                         No      -0.000250138
h(log_brine_mass-15.5335)*log_aniso                  No      -0.0328567
h(15.5335-log_brine_mass)*log_aniso                  Yes     None
por*h(1.86057-log_co2_mass)                          No      -21.4784
h(log_co2_mass-1.46743)*h(89.8134-thick)             No      -0.0201062
h(1.46743-log_co2_mass)*h(89.8134-thick)             Yes     None
h(log_co2_mass-9.61547)*h(89.8134-thick)             No      0.00751165
h(9.61547-log_co2_mass)*h(89.8134-thick)             No      -0.0053759
h(por-0.199086)                                      No      -1523.21
h(0.199086-por)                                      No      -2.3793
h(log_co2_mass-9.94994)*h(0.199086-por)              No      0.88942
h(9.94994-log_co2_mass)*h(0.199086-por)              Yes     None
h(log_brine_mass-22.6038)*h(0.199086-por)            No      9.60129
h(22.6038-log_brine_mass)*h(0.199086-por)            No      0.177271
h(log_brine_mass-22.1639)*h(log_co2_mass-1.86057)    No      -0.0478807
h(22.1639-log_brine_mass)*h(log_co2_mass-1.86057)    Yes     None
h(log_co2_mass-0.976548)*h(0.199086-por)             No      -0.431609
h(0.976548-log_co2_mass)*h(0.199086-por)             No      -42.6082
h(log_co2_mass-0.968976)*log_permh                   No      -4.34605
h(0.968976-log_co2_mass)*log_permh                   No      4.01833
h(log_co2_mass-3.36032)*h(log_brine_mass-8.98141)    No      0.0472834
h(3.36032-log_co2_mass)*h(log_brine_mass-8.98141)    Yes     None
h(log_brine_mass-12.7843)*h(log_brine_mass-8.98141)  Yes     None
h(12.7843-log_brine_mass)*h(log_brine_mass-8.98141)  No      0.0554069
log_brine_mass*h(1.86057-log_co2_mass)               No      -0.0505962
---------------------------------------------------------------------------
MSE: 0.4824, GCV: 0.5015, RSQ: 0.8096, GRSQ: 0.8021
parameters:
X[ 0 ] =  thick
X[ 1 ] =  depth
X[ 2 ] =  por
X[ 3 ] =  log_permh
X[ 4 ] =  log_aniso
X[ 5 ] =  rel_vol_frac_calcite
X[ 6 ] =  log_co2_rate
X[ 7 ] =  log_brine_rate
X[ 8 ] =  time
X[ 9 ] =  log_co2_mass
X[ 10 ] =  log_brine_mass
'''
def model(example_iterator):
    accessors = [
        lambda x: -23.18034831575112,
        lambda x: 4.595469859835881 * max(0, 1.8605676913276468 - x[9]),
        lambda x: -3.515993774045528 * max(0, x[10] - 8.981405456517138),
        lambda x: -0.01966606162833393 * max(0, 8.981405456517138 - x[10]),
        lambda x: 0.22331821747994818 * max(0, x[9] - 1.9826732768350734) *\
            max(0, x[10] - 8.981405456517138),
        lambda x: -0.2686919763443996 * max(0, x[9] - 15.473047284210848) *\
            max(0, x[10] - 8.981405456517138),
        lambda x: 0.22942699706524097 * max(0, 15.473047284210848 - x[9]) *\
            max(0, x[10] - 8.981405456517138),
        lambda x: -9.629792291322273 * max(0, x[0] - 89.81338811409051),
        lambda x: 0.05398075787270612 * max(0, 89.81338811409051 - x[0]),
        lambda x: 0.36079040130293266 * x[4],
        lambda x: 0.03138350988784816 * x[7] * max(0, x[10] - 8.981405456517138),
        lambda x: -0.02214618994413953 * x[7] * max(0, x[9] - 1.8605676913276468),
        lambda x: 0.012866004729607639 * max(0, x[9] - 2.63465928113247) *\
            max(0, 89.81338811409051 - x[0]),
        lambda x: -0.01987065985688917 * max(0, x[9] - 4.623087683650373) * x[4],
        lambda x: -0.08945070230713213 * max(0, 4.623087683650373 - x[9]) * x[4],
        lambda x: -0.15381409202091456 * x[3] * x[3],
        lambda x: 0.012929271250153154 * max(0, 8.022186246547033 - x[9]) *\
            max(0, x[10] - 8.981405456517138),
        lambda x: 4.344291175649378 * max(0, x[9] - 1.9007905337995301) * x[3],
        lambda x: -4.023732859703216 * max(0, 1.9007905337995301 - x[9]) * x[3],
        lambda x: 0.012607753877015515 * max(0, 17.74751202809935 - x[9]) *\
            max(0, x[9] - 1.8605676913276468),
        lambda x: -0.00025013818516228525 * x[8] * max(0, x[9] - 1.8605676913276468),
        lambda x: -0.032856662601092906 * max(0, x[10] - 15.533467175295991) * x[4],
        lambda x: -21.47838748139721 * x[2] * max(0, 1.8605676913276468 - x[9]),
        lambda x: -0.02010621397256207 * max(0, x[9] - 1.4674255651428059) *\
            max(0, 89.81338811409051 - x[0]),
        lambda x: 0.00751164948946359 * max(0, x[9] - 9.615469959888514) *\
            max(0, 89.81338811409051 - x[0]),
        lambda x: -0.0053759020667657476 * max(0, 9.615469959888514 - x[9]) *\
            max(0, 89.81338811409051 - x[0]),
        lambda x: -1523.2145756538705 * max(0, x[2] - 0.19908597940829562),
        lambda x: -2.379296809803425 * max(0, 0.19908597940829562 - x[2]),
        lambda x: 0.8894197378232599 * max(0, x[9] - 9.9499402340755) *\
            max(0, 0.19908597940829562 - x[2]),
        lambda x: 9.601287716941046 * max(0, x[10] - 22.603820744582922) *\
            max(0, 0.19908597940829562 - x[2]),
        lambda x: 0.1772713492060684 * max(0, 22.603820744582922 - x[10]) *\
            max(0, 0.19908597940829562 - x[2]),
        lambda x: -0.047880652209190716 * max(0, x[10] - 22.163891453012752) *\
            max(0, x[9] - 1.8605676913276468),
        lambda x: -0.43160924699219 * max(0, x[9] - 0.9765484367294885) *\
            max(0, 0.19908597940829562 - x[2]),
        lambda x: -42.608206027517525 * max(0, 0.9765484367294885 - x[9]) *\
            max(0, 0.19908597940829562 - x[2]),
        lambda x: -4.3460456334237065 * max(0, x[9] - 0.9689759425412195) * x[3],
        lambda x: 4.018330655984844 * max(0, 0.9689759425412195 - x[9]) * x[3],
        lambda x: 0.04728344935532175 * max(0, x[9] - 3.3603209513986174) *\
            max(0, x[10] - 8.981405456517138),
        lambda x: 0.055406901687755875 * max(0, 12.78431260136696 - x[10]) *\
            max(0, x[10] - 8.981405456517138),
        lambda x: -0.05059618008952897 * x[10] * max(0, 1.8605676913276468 - x[9])]
    for x in example_iterator:
        yield sum(accessor(x) for accessor in accessors)
