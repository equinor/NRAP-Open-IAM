'''
output: dis_log_dz
prediction score: 0.7672458560525095
Forward Pass
---------------------------------------------------------------
iter  parent  var  knot  mse       terms  gcv    rsq    grsq
---------------------------------------------------------------
0     -       -    -     1.238505  1      1.239  0.000  0.000
1     0       9    1802  0.551560  3      0.553  0.555  0.554
2     0       0    -1    0.498390  4      0.500  0.598  0.596
3     0       3    -1    0.464927  5      0.467  0.625  0.623
4     2       10   -1    0.431191  6      0.434  0.652  0.650
5     0       4    -1    0.403849  7      0.406  0.674  0.672
6     0       10   1933  0.382731  9      0.386  0.691  0.688
7     8       9    4297  0.354914  11     0.359  0.713  0.711
8     6       9    1216  0.343717  13     0.348  0.722  0.719
9     0       8    -1    0.337655  14     0.342  0.727  0.724
10    3       9    646   0.331347  16     0.337  0.732  0.728
11    4       9    2740  0.325503  18     0.331  0.737  0.733
12    13      2    3729  0.320772  20     0.327  0.741  0.736
13    3       1    -1    0.316090  21     0.323  0.745  0.740
14    4       3    -1    0.312222  22     0.319  0.748  0.743
15    1       10   4     0.308265  24     0.316  0.751  0.745
16    3       10   3542  0.305255  26     0.313  0.754  0.747
17    8       9    2874  0.302563  28     0.311  0.756  0.749
18    1       9    3658  0.299891  30     0.309  0.758  0.751
19    3       9    4501  0.295753  32     0.305  0.761  0.754
20    6       9    27    0.292401  34     0.302  0.764  0.756
21    4       8    -1    0.289894  35     0.300  0.766  0.758
22    0       9    1775  0.287490  37     0.298  0.768  0.759
23    36      2    -1    0.283915  38     0.295  0.771  0.762
24    8       9    4111  0.281803  40     0.293  0.772  0.763
25    4       9    2912  0.278922  42     0.291  0.775  0.765
26    2       2    -1    0.276643  43     0.289  0.777  0.767
27    6       10   3525  0.274670  45     0.287  0.778  0.768
28    36      9    268   0.272771  47     0.286  0.780  0.769
29    3       9    2359  0.270659  49     0.284  0.781  0.771
30    8       1    -1    0.269136  50     0.283  0.783  0.772
31    13      8    -1    0.267640  51     0.282  0.784  0.773
32    13      10   1251  0.265969  53     0.280  0.785  0.774
33    3       0    -1    0.264835  54     0.280  0.786  0.774
---------------------------------------------------------------
Stopping Condition 2: Improvement below threshold

Pruning Pass
----------------------------------------------
iter  bf  terms  mse   gcv    rsq     grsq
----------------------------------------------
0     -   54     0.27  0.280  0.786   0.774
1     35  53     0.27  0.279  0.786   0.774
2     26  52     0.27  0.279  0.786   0.775
3     33  51     0.27  0.279  0.786   0.775
4     14  50     0.27  0.279  0.786   0.775
5     38  49     0.27  0.278  0.786   0.775
6     31  48     0.27  0.278  0.786   0.776
7     4   47     0.27  0.278  0.786   0.776
8     5   46     0.27  0.277  0.786   0.776
9     2   45     0.27  0.277  0.786   0.776
10    12  44     0.27  0.277  0.786   0.776
11    28  43     0.27  0.277  0.786   0.777
12    23  42     0.27  0.276  0.786   0.777
13    47  41     0.27  0.276  0.786   0.777
14    24  40     0.27  0.276  0.786   0.777
15    52  39     0.27  0.277  0.785   0.777
16    15  38     0.27  0.277  0.785   0.776
17    43  37     0.27  0.277  0.784   0.776
18    6   36     0.27  0.278  0.784   0.776
19    44  35     0.27  0.278  0.783   0.776
20    30  34     0.27  0.278  0.783   0.775
21    18  33     0.27  0.279  0.782   0.775
22    9   32     0.27  0.280  0.781   0.774
23    53  31     0.27  0.281  0.780   0.773
24    51  30     0.27  0.282  0.779   0.772
25    8   29     0.28  0.283  0.778   0.772
26    50  28     0.28  0.284  0.777   0.771
27    39  27     0.28  0.285  0.776   0.770
28    45  26     0.28  0.287  0.774   0.768
29    29  25     0.28  0.289  0.772   0.767
30    34  24     0.28  0.291  0.771   0.765
31    13  23     0.28  0.291  0.771   0.765
32    42  22     0.29  0.294  0.768   0.763
33    41  21     0.29  0.297  0.765   0.760
34    21  20     0.29  0.297  0.765   0.761
35    17  19     0.29  0.297  0.765   0.760
36    49  18     0.30  0.301  0.761   0.757
37    22  17     0.30  0.302  0.760   0.756
38    20  16     0.30  0.306  0.757   0.753
39    37  15     0.31  0.310  0.753   0.750
40    25  14     0.31  0.315  0.749   0.746
41    46  13     0.31  0.318  0.746   0.743
42    1   12     0.32  0.327  0.739   0.736
43    48  11     0.33  0.335  0.733   0.730
44    19  10     0.34  0.344  0.725   0.722
45    7   9      0.36  0.365  0.708   0.706
46    27  8      0.37  0.374  0.700   0.698
47    40  7      0.39  0.397  0.681   0.679
48    36  6      0.42  0.417  0.665   0.663
49    16  5      0.42  0.423  0.660   0.658
50    32  4      0.44  0.445  0.642   0.640
51    11  3      0.45  0.450  0.638   0.637
52    3   2      0.50  0.499  0.598   0.597
53    10  1      1.24  1.239  -0.000  -0.000
----------------------------------------------
Selected iteration: 13

Earth Model
-------------------------------------------------------------------------
Basis Function                                     Pruned  Coefficient
-------------------------------------------------------------------------
(Intercept)                                        No      -17.6573
h(log_co2_mass-0.56226)                            No      0.311182
h(0.56226-log_co2_mass)                            Yes     None
thick                                              No      0.0280352
log_permh                                          Yes     None
log_brine_mass*h(0.56226-log_co2_mass)             Yes     None
log_aniso                                          No      0.149528
h(log_brine_mass-16.8061)                          No      0.175783
h(16.8061-log_brine_mass)                          No      -0.122196
h(log_co2_mass-1.04597)*h(16.8061-log_brine_mass)  No      0.00652429
h(1.04597-log_co2_mass)*h(16.8061-log_brine_mass)  No      -0.295144
h(log_co2_mass-0.781516)*log_aniso                 No      0.151378
h(0.781516-log_co2_mass)*log_aniso                 Yes     None
time                                               No      -0.0431807
h(log_co2_mass-0.829557)*thick                     Yes     None
h(0.829557-log_co2_mass)*thick                     No      -0.00797169
h(log_co2_mass-0.520998)*log_permh                 No      -0.585245
h(0.520998-log_co2_mass)*log_permh                 No      0.65209
h(por-0.199086)*time                               No      -27.0236
h(0.199086-por)*time                               No      -0.0355481
depth*thick                                        No      -1.04312e-05
log_permh*log_permh                                No      -0.0896324
h(log_brine_mass-10.5496)*h(log_co2_mass-0.56226)  No      -0.00322541
h(10.5496-log_brine_mass)*h(log_co2_mass-0.56226)  Yes     None
h(log_brine_mass-0.0910052)*thick                  No      0.000161581
h(0.0910052-log_brine_mass)*thick                  No      0.183405
h(log_co2_mass-18.7071)*h(16.8061-log_brine_mass)  Yes     None
h(18.7071-log_co2_mass)*h(16.8061-log_brine_mass)  No      0.0136434
h(log_co2_mass-13.4963)*h(log_co2_mass-0.56226)    Yes     None
h(13.4963-log_co2_mass)*h(log_co2_mass-0.56226)    No      -0.00996379
h(log_co2_mass-6.06077)*thick                      No      -0.00033762
h(6.06077-log_co2_mass)*thick                      Yes     None
h(log_co2_mass-3.14077)*log_aniso                  No      -0.17606
h(3.14077-log_co2_mass)*log_aniso                  Yes     None
time*log_permh                                     No      -0.00295447
h(log_co2_mass-4.71305)                            Yes     None
h(4.71305-log_co2_mass)                            No      1.19071
por*h(4.71305-log_co2_mass)                        No      -1.37718
h(log_co2_mass-2.74709)*h(16.8061-log_brine_mass)  Yes     None
h(2.74709-log_co2_mass)*h(16.8061-log_brine_mass)  No      -0.0236774
h(log_co2_mass-4.86956)*log_permh                  No      0.604451
h(4.86956-log_co2_mass)*log_permh                  No      -0.511226
por*h(0.56226-log_co2_mass)                        No      10.1033
h(log_brine_mass-17.1122)*log_aniso                No      -0.0206724
h(17.1122-log_brine_mass)*log_aniso                No      -0.0100422
h(log_co2_mass-4.68641)*h(4.71305-log_co2_mass)    No      -8851.46
h(4.68641-log_co2_mass)*h(4.71305-log_co2_mass)    No      0.153264
h(log_co2_mass-2.96092)*thick                      Yes     None
h(2.96092-log_co2_mass)*thick                      No      -0.0099519
depth*h(16.8061-log_brine_mass)                    No      3.6246e-05
time*time                                          No      0.00011141
h(log_brine_mass-0.841887)*time                    No      -0.000224299
h(0.841887-log_brine_mass)*time                    No      -0.0567701
thick*thick                                        No      -0.000128494
-------------------------------------------------------------------------
MSE: 0.2653, GCV: 0.2764, RSQ: 0.7858, GRSQ: 0.7769
parameters:
X[ 0 ] =  thick
X[ 1 ] =  depth
X[ 2 ] =  por
X[ 3 ] =  log_permh
X[ 4 ] =  log_aniso
X[ 5 ] =  rel_vol_frac_calcite
X[ 6 ] =  log_co2_rate
X[ 7 ] =  log_brine_rate
X[ 8 ] =  time
X[ 9 ] =  log_co2_mass
X[ 10 ] =  log_brine_mass
'''
def model(example_iterator):
    accessors = [
        lambda x: -17.657293713132713,
        lambda x: 0.31118174775834884 * max(0, x[9] - 0.562259551100686),
        lambda x: 0.02803519899051493 * x[0],
        lambda x: 0.14952763845508524 * x[4],
        lambda x: 0.17578335086053695 * max(0, x[10] - 16.80605043029624),
        lambda x: -0.12219563788236361 * max(0, 16.80605043029624 - x[10]),
        lambda x: 0.006524292061699672 * max(0, x[9] - 1.0459657036431245) *\
            max(0, 16.80605043029624 - x[10]),
        lambda x: -0.2951439783188696 * max(0, 1.0459657036431245 - x[9]) *\
            max(0, 16.80605043029624 - x[10]),
        lambda x: 0.1513777045683755 * max(0, x[9] - 0.7815164007620621) * x[4],
        lambda x: -0.043180709760921386 * x[8],
        lambda x: -0.007971691345593624 * max(0, 0.8295565576987849 - x[9]) * x[0],
        lambda x: -0.5852448368774972 * max(0, x[9] - 0.5209976697823273) * x[3],
        lambda x: 0.6520903401636711 * max(0, 0.5209976697823273 - x[9]) * x[3],
        lambda x: -27.023593064271303 * max(0, x[2] - 0.19908597940829562) * x[8],
        lambda x: -0.03554813763446371 * max(0, 0.19908597940829562 - x[2]) * x[8],
        lambda x: -1.0431217265738368e-05 * x[1] * x[0],
        lambda x: -0.0896323621419716 * x[3] * x[3],
        lambda x: -0.003225413129028361 * max(0, x[10] - 10.549561156153032) *\
            max(0, x[9] - 0.562259551100686),
        lambda x: 0.00016158085225989952 * max(0, x[10] - 0.09100520855666858) * x[0],
        lambda x: 0.1834048001010991 * max(0, 0.09100520855666858 - x[10]) * x[0],
        lambda x: 0.013643393566641012 * max(0, 18.70709200434045 - x[9]) *\
            max(0, 16.80605043029624 - x[10]),
        lambda x: -0.009963794203277521 * max(0, 13.496346989316597 - x[9]) *\
            max(0, x[9] - 0.562259551100686),
        lambda x: -0.0003376201490596022 * max(0, x[9] - 6.060766047629537) * x[0],
        lambda x: -0.17606004763776734 * max(0, x[9] - 3.140768741577983) * x[4],
        lambda x: -0.0029544718125866726 * x[8] * x[3],
        lambda x: 1.1907073539810165 * max(0, 4.7130504323854305 - x[9]),
        lambda x: -1.3771764997450255 * x[2] * max(0, 4.7130504323854305 - x[9]),
        lambda x: -0.023677384772329644 * max(0, 2.747094354247078 - x[9]) *\
            max(0, 16.80605043029624 - x[10]),
        lambda x: 0.6044513357912489 * max(0, x[9] - 4.8695634691864855) * x[3],
        lambda x: -0.5112257701640662 * max(0, 4.8695634691864855 - x[9]) * x[3],
        lambda x: 10.103347541359733 * x[2] * max(0, 0.562259551100686 - x[9]),
        lambda x: -0.020672443030320516 * max(0, x[10] - 17.112161441262554) * x[4],
        lambda x: -0.01004222302527465 * max(0, 17.112161441262554 - x[10]) * x[4],
        lambda x: -8851.456269035878 * max(0, x[9] - 4.6864140614076435) *\
            max(0, 4.7130504323854305 - x[9]),
        lambda x: 0.1532642543286443 * max(0, 4.6864140614076435 - x[9]) *\
            max(0, 4.7130504323854305 - x[9]),
        lambda x: -0.009951896521552542 * max(0, 2.960923817310084 - x[9]) * x[0],
        lambda x: 3.624599529521849e-05 * x[1] * max(0, 16.80605043029624 - x[10]),
        lambda x: 0.0001114101521528521 * x[8] * x[8],
        lambda x: -0.0002242991098626492 * max(0, x[10] - 0.8418866727325621) * x[8],
        lambda x: -0.05677008688905135 * max(0, 0.8418866727325621 - x[10]) * x[8],
        lambda x: -0.00012849444587636344 * x[0] * x[0]]
    for x in example_iterator:
        yield sum(accessor(x) for accessor in accessors)
