'''
output: tds_log_vol
prediction score: 0.9611965441036974
Forward Pass
-----------------------------------------------------------------
iter  parent  var  knot  mse        terms  gcv     rsq    grsq
-----------------------------------------------------------------
0     -       -    -     42.240575  1      42.257  0.000  0.000
1     0       10   4083  4.731360   3      4.743   0.888  0.888
2     0       9    775   3.788508   5      3.805   0.910  0.910
3     3       10   -1    2.453432   6      2.467   0.942  0.942
4     0       2    -1    2.136225   7      2.150   0.949  0.949
5     4       10   2478  1.897465   9      1.914   0.955  0.955
6     6       10   4594  1.827943   11     1.847   0.957  0.956
7     3       7    -1    1.770554   12     1.791   0.958  0.958
8     1       9    3418  1.704960   14     1.728   0.960  0.959
9     1       3    3737  1.648912   16     1.675   0.961  0.960
10    0       1    -1    1.604004   17     1.631   0.962  0.961
11    16      10   4101  1.549855   19     1.579   0.963  0.963
12    16      9    3505  1.518832   21     1.550   0.964  0.963
-----------------------------------------------------------------
Stopping Condition 2: Improvement below threshold

Pruning Pass
------------------------------------------------
iter  bf  terms  mse    gcv     rsq     grsq
------------------------------------------------
0     -   21     1.52   1.550   0.964   0.963
1     20  20     1.52   1.552   0.964   0.963
2     9   19     1.53   1.554   0.964   0.963
3     8   18     1.53   1.558   0.964   0.963
4     12  17     1.54   1.563   0.964   0.963
5     4   16     1.55   1.571   0.963   0.963
6     15  15     1.57   1.590   0.963   0.962
7     19  14     1.59   1.616   0.962   0.962
8     14  13     1.63   1.651   0.961   0.961
9     10  12     1.67   1.691   0.960   0.960
10    2   11     1.71   1.723   0.960   0.959
11    17  10     1.73   1.745   0.959   0.959
12    18  9      1.75   1.760   0.959   0.958
13    16  8      1.79   1.802   0.958   0.957
14    11  7      1.88   1.895   0.955   0.955
15    6   6      2.15   2.158   0.949   0.949
16    13  5      2.48   2.490   0.941   0.941
17    7   4      2.50   2.508   0.941   0.941
18    5   3      3.88   3.888   0.908   0.908
19    3   2      4.86   4.870   0.885   0.885
20    1   1      42.24  42.257  -0.000  -0.000
------------------------------------------------
Selected iteration: 0

Earth Model
-------------------------------------------------------------------------
Basis Function                                     Pruned  Coefficient
-------------------------------------------------------------------------
(Intercept)                                        No      3.22256
h(log_brine_mass-3.76763)                          No      0.598507
h(3.76763-log_brine_mass)                          No      -0.717837
h(log_co2_mass-14.157)                             No      1.02201
h(14.157-log_co2_mass)                             No      -0.181247
log_brine_mass*h(log_co2_mass-14.157)              No      -0.0263496
por                                                No      -13.7821
h(log_brine_mass-9.49759)*h(14.157-log_co2_mass)   No      -0.0903385
h(9.49759-log_brine_mass)*h(14.157-log_co2_mass)   No      0.0126808
h(log_brine_mass-5.2993)*por                       No      0.249749
h(5.2993-log_brine_mass)*por                       No      2.59388
log_brine_rate*h(log_co2_mass-14.157)              No      0.150802
h(log_co2_mass-19.7498)*h(log_brine_mass-3.76763)  No      -0.0321345
h(19.7498-log_co2_mass)*h(log_brine_mass-3.76763)  No      0.064718
h(log_permh+11.018)*h(log_brine_mass-3.76763)      No      -86.252
h(-11.018-log_permh)*h(log_brine_mass-3.76763)     No      -0.0161012
depth                                              No      0.00468791
h(log_brine_mass-5.25677)*depth                    No      -0.000236036
h(5.25677-log_brine_mass)*depth                    No      -0.00082766
h(log_co2_mass-12.9175)*depth                      No      -0.000384636
h(12.9175-log_co2_mass)*depth                      No      -8.07635e-05
-------------------------------------------------------------------------
MSE: 1.5188, GCV: 1.5503, RSQ: 0.9640, GRSQ: 0.9633
parameters:
X[ 0 ] =  thick
X[ 1 ] =  depth
X[ 2 ] =  por
X[ 3 ] =  log_permh
X[ 4 ] =  log_aniso
X[ 5 ] =  rel_vol_frac_calcite
X[ 6 ] =  log_co2_rate
X[ 7 ] =  log_brine_rate
X[ 8 ] =  time
X[ 9 ] =  log_co2_mass
X[ 10 ] =  log_brine_mass
'''
def model(example_iterator):
    accessors = [
        lambda x: 3.222557176879782,
        lambda x: 0.5985066458740231 * max(0, x[10] - 3.7676271313650327),
        lambda x: -0.7178370457787091 * max(0, 3.7676271313650327 - x[10]),
        lambda x: 1.0220085360767226 * max(0, x[9] - 14.156960509631569),
        lambda x: -0.18124716827367682 * max(0, 14.156960509631569 - x[9]),
        lambda x: -0.026349646040114458 * x[10] * max(0, x[9] - 14.156960509631569),
        lambda x: -13.782127695090743 * x[2],
        lambda x: -0.09033847766056226 * max(0, x[10] - 9.497587739601345) *\
            max(0, 14.156960509631569 - x[9]),
        lambda x: 0.012680759153459033 * max(0, 9.497587739601345 - x[10]) *\
            max(0, 14.156960509631569 - x[9]),
        lambda x: 0.2497490904399012 * max(0, x[10] - 5.299304690478259) * x[2],
        lambda x: 2.5938799577440843 * max(0, 5.299304690478259 - x[10]) * x[2],
        lambda x: 0.1508020465932391 * x[7] * max(0, x[9] - 14.156960509631569),
        lambda x: -0.03213446397218404 * max(0, x[9] - 19.749832466836693) *\
            max(0, x[10] - 3.7676271313650327),
        lambda x: 0.06471804516138802 * max(0, 19.749832466836693 - x[9]) *\
            max(0, x[10] - 3.7676271313650327),
        lambda x: -86.2520345535416 * max(0, x[3] - -11.017956539011895) *\
            max(0, x[10] - 3.7676271313650327),
        lambda x: -0.016101166732881173 * max(0, -11.017956539011895 - x[3]) *\
            max(0, x[10] - 3.7676271313650327),
        lambda x: 0.004687913995022455 * x[1],
        lambda x: -0.00023603556805451564 * max(0, x[10] - 5.2567713302600945) * x[1],
        lambda x: -0.0008276599345091312 * max(0, 5.2567713302600945 - x[10]) * x[1],
        lambda x: -0.00038463602626523374 * max(0, x[9] - 12.917477426304162) * x[1],
        lambda x: -8.076354654457107e-05 * max(0, 12.917477426304162 - x[9]) * x[1]]
    for x in example_iterator:
        yield sum(accessor(x) for accessor in accessors)
