'''
output: tds_log_dz
prediction score: 0.8308964991283221
Forward Pass
---------------------------------------------------------------
iter  parent  var  knot  mse       terms  gcv    rsq    grsq
---------------------------------------------------------------
0     -       -    -     2.702429  1      2.704  0.000  0.000
1     0       10   4002  1.188185  3      1.191  0.560  0.559
2     2       9    99    0.793875  5      0.797  0.706  0.705
3     2       10   1985  0.717045  7      0.722  0.735  0.733
4     0       3    3737  0.643809  9      0.649  0.762  0.760
5     0       0    -1    0.596075  10     0.602  0.779  0.777
6     0       4    -1    0.567125  11     0.573  0.790  0.788
7     9       10   4176  0.545772  13     0.553  0.798  0.796
8     0       8    -1    0.523368  14     0.530  0.806  0.804
9     8       10   2597  0.501330  16     0.509  0.814  0.812
10    10      10   51    0.491473  18     0.500  0.818  0.815
11    13      10   327   0.483643  20     0.493  0.821  0.818
12    13      9    614   0.477033  22     0.487  0.823  0.820
13    10      9    1222  0.471112  24     0.482  0.826  0.822
14    9       9    2155  0.462934  26     0.475  0.829  0.824
15    1       9    1100  0.456645  28     0.469  0.831  0.826
16    9       9    3480  0.450286  30     0.464  0.833  0.828
17    1       9    3039  0.444528  32     0.459  0.836  0.830
18    2       2    -1    0.440287  33     0.455  0.837  0.832
19    10      10   1646  0.435557  35     0.451  0.839  0.833
20    8       1    -1    0.431113  36     0.447  0.840  0.835
21    9       10   107   0.428247  38     0.445  0.842  0.835
22    9       9    4505  0.425655  40     0.443  0.842  0.836
---------------------------------------------------------------
Stopping Condition 2: Improvement below threshold

Pruning Pass
----------------------------------------------
iter  bf  terms  mse   gcv    rsq     grsq
----------------------------------------------
0     -   40     0.43  0.443  0.842   0.836
1     36  39     0.43  0.443  0.842   0.836
2     34  38     0.43  0.442  0.842   0.836
3     31  37     0.43  0.442  0.842   0.837
4     39  36     0.43  0.441  0.842   0.837
5     24  35     0.43  0.441  0.842   0.837
6     20  34     0.43  0.440  0.842   0.837
7     4   33     0.43  0.440  0.842   0.837
8     17  32     0.43  0.440  0.842   0.837
9     22  31     0.43  0.439  0.842   0.837
10    29  30     0.43  0.439  0.842   0.838
11    14  29     0.43  0.439  0.842   0.838
12    6   28     0.43  0.440  0.842   0.837
13    2   27     0.43  0.440  0.842   0.837
14    19  26     0.43  0.440  0.841   0.837
15    27  25     0.43  0.443  0.840   0.836
16    30  24     0.44  0.446  0.839   0.835
17    35  23     0.44  0.449  0.837   0.834
18    7   22     0.44  0.454  0.836   0.832
19    21  21     0.45  0.459  0.834   0.830
20    32  20     0.46  0.465  0.831   0.828
21    23  19     0.46  0.470  0.829   0.826
22    10  18     0.46  0.471  0.829   0.826
23    26  17     0.47  0.476  0.827   0.824
24    18  16     0.47  0.480  0.825   0.823
25    11  15     0.48  0.487  0.822   0.820
26    25  14     0.49  0.495  0.819   0.817
27    28  13     0.50  0.511  0.813   0.811
28    38  12     0.51  0.511  0.813   0.811
29    37  11     0.52  0.528  0.807   0.805
30    15  10     0.55  0.556  0.796   0.794
31    13  9      0.59  0.592  0.783   0.781
32    5   8      0.65  0.659  0.758   0.756
33    1   7      0.71  0.712  0.738   0.737
34    16  6      0.72  0.726  0.733   0.732
35    33  5      0.80  0.806  0.703   0.702
36    8   4      0.88  0.883  0.674   0.673
37    9   3      1.08  1.078  0.602   0.601
38    3   2      1.40  1.404  0.481   0.481
39    12  1      2.70  2.704  -0.000  -0.000
----------------------------------------------
Selected iteration: 10

Earth Model
---------------------------------------------------------------------------
Basis Function                                       Pruned  Coefficient
---------------------------------------------------------------------------
(Intercept)                                          No      0.62922
h(log_brine_mass-9.63558)                            No      0.171523
h(9.63558-log_brine_mass)                            No      -0.100621
h(log_co2_mass-11.9447)*h(9.63558-log_brine_mass)    No      0.0469867
h(11.9447-log_co2_mass)*h(9.63558-log_brine_mass)    Yes     None
h(log_brine_mass-5.62549)*h(9.63558-log_brine_mass)  No      0.241709
h(5.62549-log_brine_mass)*h(9.63558-log_brine_mass)  No      0.0117709
h(log_permh+11.018)                                  No      -128.328
h(-11.018-log_permh)                                 No      0.559763
thick                                                No      0.0184498
log_aniso                                            No      0.232041
h(log_brine_mass-9.67646)*thick                      No      -0.000740488
h(9.67646-log_brine_mass)*thick                      No      -0.00514909
time                                                 No      -0.0120603
h(log_brine_mass-9.99243)*h(-11.018-log_permh)       No      -0.00792929
h(9.99243-log_brine_mass)*h(-11.018-log_permh)       No      -0.0512372
h(log_brine_mass-9.80538)*log_aniso                  No      -0.212372
h(9.80538-log_brine_mass)*log_aniso                  Yes     None
h(log_brine_mass-16.4379)*time                       No      0.00159437
h(16.4379-log_brine_mass)*time                       No      0.000394745
h(log_co2_mass-2.05326)*time                         Yes     None
h(2.05326-log_co2_mass)*time                         No      0.0119527
h(log_co2_mass-19.4732)*log_aniso                    Yes     None
h(19.4732-log_co2_mass)*log_aniso                    No      -0.0115686
h(log_co2_mass-15.0808)*thick                        Yes     None
h(15.0808-log_co2_mass)*thick                        No      0.000602253
h(log_co2_mass-13.6376)*h(log_brine_mass-9.63558)    No      -0.0165039
h(13.6376-log_co2_mass)*h(log_brine_mass-9.63558)    No      -0.00370396
h(log_co2_mass-18.138)*thick                         No      -0.0111835
h(18.138-log_co2_mass)*thick                         Yes     None
h(log_co2_mass-18.965)*h(log_brine_mass-9.63558)     No      0.0250869
h(18.965-log_co2_mass)*h(log_brine_mass-9.63558)     Yes     None
por*h(9.63558-log_brine_mass)                        No      -0.312162
h(log_brine_mass-7.63129)*log_aniso                  No      0.176744
h(7.63129-log_brine_mass)*log_aniso                  Yes     None
depth*h(-11.018-log_permh)                           No      0.000218801
h(log_brine_mass-5.80057)*thick                      Yes     None
h(5.80057-log_brine_mass)*thick                      No      0.00399212
h(log_co2_mass-16.4098)*thick                        No      0.00885407
h(16.4098-log_co2_mass)*thick                        Yes     None
---------------------------------------------------------------------------
MSE: 0.4263, GCV: 0.4391, RSQ: 0.8423, GRSQ: 0.8376
parameters:
X[ 0 ] =  thick
X[ 1 ] =  depth
X[ 2 ] =  por
X[ 3 ] =  log_permh
X[ 4 ] =  log_aniso
X[ 5 ] =  rel_vol_frac_calcite
X[ 6 ] =  log_co2_rate
X[ 7 ] =  log_brine_rate
X[ 8 ] =  time
X[ 9 ] =  log_co2_mass
X[ 10 ] =  log_brine_mass
'''
def model(example_iterator):
    accessors = [
        lambda x: 0.6292200475791773,
        lambda x: 0.17152289238181118 * max(0, x[10] - 9.635580721748312),
        lambda x: -0.10062100842308609 * max(0, 9.635580721748312 - x[10]),
        lambda x: 0.0469866825961656 * max(0, x[9] - 11.944722219893636) *\
             max(0, 9.635580721748312 - x[10]),
        lambda x: 0.24170903750683664 * max(0, x[10] - 5.625486477182836) *\
             max(0, 9.635580721748312 - x[10]),
        lambda x: 0.011770944100957982 * max(0, 5.625486477182836 - x[10]) *\
             max(0, 9.635580721748312 - x[10]),
        lambda x: -128.32788512883994 * max(0, x[3] - -11.017956539011895),
        lambda x: 0.5597631674564418 * max(0, -11.017956539011895 - x[3]),
        lambda x: 0.01844977620980414 * x[0],
        lambda x: 0.23204055510825358 * x[4],
        lambda x: -0.0007404879567342523 * max(0, x[10] - 9.676458052348375) * x[0],
        lambda x: -0.0051490935212911565 * max(0, 9.676458052348375 - x[10]) * x[0],
        lambda x: -0.01206032519355804 * x[8],
        lambda x: -0.007929290858007225 * max(0, x[10] - 9.992426766188984) *\
             max(0, -11.017956539011895 - x[3]),
        lambda x: -0.051237213894644223 * max(0, 9.992426766188984 - x[10]) *\
             max(0, -11.017956539011895 - x[3]),
        lambda x: -0.21237198426967036 * max(0, x[10] - 9.80538318052582) * x[4],
        lambda x: 0.001594367495578593 * max(0, x[10] - 16.437903255919522) * x[8],
        lambda x: 0.0003947450938284608 * max(0, 16.437903255919522 - x[10]) * x[8],
        lambda x: 0.011952713445944221 * max(0, 2.053261931854735 - x[9]) * x[8],
        lambda x: -0.011568604675185681 * max(0, 19.473239840372543 - x[9]) * x[4],
        lambda x: 0.0006022532304876538 * max(0, 15.080781636596072 - x[9]) * x[0],
        lambda x: -0.01650389724700614 * max(0, x[9] - 13.637619546131905) *\
             max(0, x[10] - 9.635580721748312),
        lambda x: -0.003703961343602862 * max(0, 13.637619546131905 - x[9]) *\
             max(0, x[10] - 9.635580721748312),
        lambda x: -0.011183494268773284 * max(0, x[9] - 18.138000585511097) * x[0],
        lambda x: 0.025086877356149152 * max(0, x[9] - 18.965014412005452) *\
             max(0, x[10] - 9.635580721748312),
        lambda x: -0.31216157381755394 * x[2] * max(0, 9.635580721748312 - x[10]),
        lambda x: 0.17674371827257032 * max(0, x[10] - 7.63128734541339) * x[4],
        lambda x: 0.00021880101948024144 * x[1] * max(0, -11.017956539011895 - x[3]),
        lambda x: 0.0039921173284141135 * max(0, 5.800574908916345 - x[10]) * x[0],
        lambda x: 0.008854074889451783 * max(0, x[9] - 16.40975793975549) * x[0]]
    for x in example_iterator:
        yield sum(accessor(x) for accessor in accessors)
