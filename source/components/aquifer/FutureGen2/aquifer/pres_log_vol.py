'''
output: pres_log_vol
prediction score: 0.9182976669648218
Forward Pass
-------------------------------------------------------------------
iter  parent  var  knot  mse         terms  gcv      rsq    grsq
-------------------------------------------------------------------
0     -       -    -     150.510564  1      150.571  0.000  0.000
1     0       10   1493  84.643769   3      84.847   0.438  0.436
2     0       9    3189  40.640019   5      40.819   0.730  0.729
3     3       10   26    25.502957   7      25.667   0.831  0.830
4     0       3    -1    22.541682   8      22.709   0.850  0.849
5     3       9    3258  20.774215   10     20.971   0.862  0.861
6     2       9    3066  19.519510   12     19.744   0.870  0.869
7     7       10   2170  17.649313   14     17.888   0.883  0.881
8     0       8    -1    16.588451   15     16.830   0.890  0.888
9     0       1    -1    15.518651   16     15.761   0.897  0.895
10    14      10   2593  14.561620   18     14.818   0.903  0.902
11    7       10   765   13.904768   20     14.179   0.908  0.906
12    15      10   2623  13.358554   22     13.649   0.911  0.909
13    7       9    3173  12.955409   24     13.264   0.914  0.912
14    15      9    2109  12.551753   26     12.877   0.917  0.914
15    14      9    3328  12.220092   28     12.562   0.919  0.917
16    14      8    -1    11.998099   29     12.346   0.920  0.918
17    14      0    -1    11.823263   30     12.179   0.921  0.919
18    1       2    3729  11.709535   32     12.086   0.922  0.920
-------------------------------------------------------------------
Stopping Condition 2: Improvement below threshold

Pruning Pass
--------------------------------------------------
iter  bf  terms  mse     gcv      rsq     grsq
--------------------------------------------------
0     -   32     11.71   12.086   0.922   0.920
1     19  31     11.71   12.074   0.922   0.920
2     11  30     11.71   12.062   0.922   0.920
3     31  29     11.71   12.053   0.922   0.920
4     4   28     11.72   12.051   0.922   0.920
5     8   27     11.80   12.115   0.922   0.920
6     30  26     11.91   12.218   0.921   0.919
7     12  25     12.03   12.325   0.920   0.918
8     29  24     12.19   12.479   0.919   0.917
9     28  23     12.42   12.707   0.917   0.916
10    27  22     12.63   12.907   0.916   0.914
11    26  21     12.85   13.120   0.915   0.913
12    23  20     13.08   13.336   0.913   0.911
13    24  19     13.25   13.495   0.912   0.910
14    25  18     13.35   13.581   0.911   0.910
15    5   17     13.66   13.887   0.909   0.908
16    21  16     13.97   14.185   0.907   0.906
17    20  15     14.08   14.290   0.906   0.905
18    17  14     14.64   14.841   0.903   0.901
19    16  13     14.93   15.121   0.901   0.900
20    3   12     15.80   15.984   0.895   0.894
21    22  11     16.03   16.199   0.893   0.892
22    9   10     16.71   16.871   0.889   0.888
23    15  9      17.78   17.927   0.882   0.881
24    14  8      19.02   19.163   0.874   0.873
25    18  7      20.75   20.881   0.862   0.861
26    1   6      21.79   21.908   0.855   0.854
27    10  5      28.25   28.379   0.812   0.812
28    7   4      41.51   41.655   0.724   0.723
29    2   3      54.71   54.846   0.636   0.636
30    6   2      103.11  103.250  0.315   0.314
31    13  1      150.51  150.571  -0.000  -0.000
--------------------------------------------------
Selected iteration: 4

Earth Model
-------------------------------------------------------------------------
Basis Function                                     Pruned  Coefficient
-------------------------------------------------------------------------
(Intercept)                                        No      -42.2249
h(log_brine_mass-13.9639)                          No      6.26117
h(13.9639-log_brine_mass)                          No      3.12263
h(log_co2_mass-10.9082)                            No      0.589613
h(10.9082-log_co2_mass)                            Yes     None
h(log_brine_mass-20.0239)*h(log_co2_mass-10.9082)  No      -0.10792
h(20.0239-log_brine_mass)*h(log_co2_mass-10.9082)  No      0.36967
log_permh                                          No      -6.33469
h(log_co2_mass-19.2072)*h(log_co2_mass-10.9082)    No      0.30065
h(19.2072-log_co2_mass)*h(log_co2_mass-10.9082)    No      -0.178321
h(log_co2_mass-11.3706)*h(13.9639-log_brine_mass)  No      -0.388296
h(11.3706-log_co2_mass)*h(13.9639-log_brine_mass)  Yes     None
h(log_brine_mass-20.792)*log_permh                 No      0.142853
h(20.792-log_brine_mass)*log_permh                 No      0.287037
time                                               No      -0.196942
depth                                              No      0.0185399
h(log_brine_mass-17.5496)*time                     No      0.0213006
h(17.5496-log_brine_mass)*time                     No      0.00602431
h(log_brine_mass-14.0099)*log_permh                No      0.510521
h(14.0099-log_brine_mass)*log_permh                Yes     None
h(log_brine_mass-16.8559)*depth                    No      -0.00201568
h(16.8559-log_brine_mass)*depth                    No      -0.000553446
h(log_co2_mass-19.5494)*log_permh                  No      0.667152
h(19.5494-log_co2_mass)*log_permh                  No      0.0295417
h(log_co2_mass-19.3779)*depth                      No      -0.00350806
h(19.3779-log_co2_mass)*depth                      No      -0.000605523
h(log_co2_mass-16.7471)*time                       No      0.0187946
h(16.7471-log_co2_mass)*time                       No      0.00470843
time*time                                          No      0.00118665
thick*time                                         No      -0.000602145
h(por-0.199086)*h(log_brine_mass-13.9639)          No      -2954.81
h(0.199086-por)*h(log_brine_mass-13.9639)          Yes     None
-------------------------------------------------------------------------
MSE: 11.7228, GCV: 12.0508, RSQ: 0.9221, GRSQ: 0.9200
parameters:
X[ 0 ] =  thick
X[ 1 ] =  depth
X[ 2 ] =  por
X[ 3 ] =  log_permh
X[ 4 ] =  log_aniso
X[ 5 ] =  rel_vol_frac_calcite
X[ 6 ] =  log_co2_rate
X[ 7 ] =  log_brine_rate
X[ 8 ] =  time
X[ 9 ] =  log_co2_mass
X[ 10 ] =  log_brine_mass
'''
def model(example_iterator):
    accessors = [
        lambda x: -42.224882266705784,
        lambda x: 6.261166802637616 * max(0, x[10] - 13.963919458408347),
        lambda x: 3.122630779408873 * max(0, 13.963919458408347 - x[10]),
        lambda x: 0.589613259252382 * max(0, x[9] - 10.908203155711305),
        lambda x: -0.10791960805352517 * max(0, x[10] - 20.02387702704444) *\
            max(0, x[9] - 10.908203155711305),
        lambda x: 0.3696696851160503 * max(0, 20.02387702704444 - x[10]) *\
            max(0, x[9] - 10.908203155711305),
        lambda x: -6.3346867971676 * x[3],
        lambda x: 0.300649937872613 * max(0, x[9] - 19.2071904730252) *\
            max(0, x[9] - 10.908203155711305),
        lambda x: -0.1783206669929583 * max(0, 19.2071904730252 - x[9]) *\
            max(0, x[9] - 10.908203155711305),
        lambda x: -0.38829591912355843 * max(0, x[9] - 11.370635189586997) *\
            max(0, 13.963919458408347 - x[10]),
        lambda x: 0.14285264840023687 * max(0, x[10] - 20.791955739953195) * x[3],
        lambda x: 0.28703665935597256 * max(0, 20.791955739953195 - x[10]) * x[3],
        lambda x: -0.19694196017257248 * x[8],
        lambda x: 0.018539934989969697 * x[1],
        lambda x: 0.0213005704732663 * max(0, x[10] - 17.54956425423608) * x[8],
        lambda x: 0.006024313948795906 * max(0, 17.54956425423608 - x[10]) * x[8],
        lambda x: 0.5105209770096075 * max(0, x[10] - 14.009944248659812) * x[3],
        lambda x: -0.0020156790747263287 * max(0, x[10] - 16.855854726657714) * x[1],
        lambda x: -0.0005534460700280519 * max(0, 16.855854726657714 - x[10]) * x[1],
        lambda x: 0.66715239489275 * max(0, x[9] - 19.549426601484562) * x[3],
        lambda x: 0.029541673473882285 * max(0, 19.549426601484562 - x[9]) * x[3],
        lambda x: -0.003508056865554776 * max(0, x[9] - 19.377914942072753) * x[1],
        lambda x: -0.0006055227603223301 * max(0, 19.377914942072753 - x[9]) * x[1],
        lambda x: 0.01879460001481545 * max(0, x[9] - 16.747087966041793) * x[8],
        lambda x: 0.004708430003987879 * max(0, 16.747087966041793 - x[9]) * x[8],
        lambda x: 0.0011866516562502039 * x[8] * x[8],
        lambda x: -0.0006021449424964409 * x[0] * x[8],
        lambda x: -2954.8079002268064 * max(0, x[2] - 0.19908597940829562) *\
            max(0, x[10] - 13.963919458408347)]
    for x in example_iterator:
        yield sum(accessor(x) for accessor in accessors)
