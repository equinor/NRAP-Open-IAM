'''
output: pres_log_dz
prediction score: 0.8380136785839639
Forward Pass
---------------------------------------------------------------
iter  parent  var  knot  mse       terms  gcv    rsq    grsq
---------------------------------------------------------------
0     -       -    -     3.587533  1      3.589  0.000  0.000
1     0       10   2735  2.234762  3      2.240  0.377  0.376
2     2       9    548   1.333838  5      1.340  0.628  0.627
3     0       9    718   1.149854  7      1.157  0.679  0.678
4     5       10   585   0.956224  9      0.964  0.733  0.731
5     0       3    -1    0.852133  10     0.860  0.762  0.760
6     9       10   808   0.782683  12     0.792  0.782  0.779
7     0       8    -1    0.734464  13     0.744  0.795  0.793
8     9       1    -1    0.700595  14     0.710  0.805  0.802
9     0       10   2015  0.663536  16     0.674  0.815  0.812
10    12      10   3938  0.649105  18     0.661  0.819  0.816
11    5       9    848   0.633117  20     0.646  0.824  0.820
12    12      9    4810  0.618702  22     0.632  0.828  0.824
13    1       0    -1    0.606724  23     0.621  0.831  0.827
14    2       1    -1    0.595547  24     0.610  0.834  0.830
15    1       1    -1    0.584335  25     0.599  0.837  0.833
16    9       9    1402  0.573707  27     0.589  0.840  0.836
17    12      8    -1    0.565285  28     0.581  0.842  0.838
18    9       9    4143  0.559377  30     0.576  0.844  0.839
19    15      9    3239  0.550161  32     0.568  0.847  0.842
20    1       2    3729  0.544812  34     0.563  0.848  0.843
21    5       0    -1    0.539988  35     0.559  0.849  0.844
22    12      0    -1    0.531843  36     0.551  0.852  0.846
23    15      9    3577  0.527449  38     0.548  0.853  0.847
24    12      9    4146  0.523402  40     0.545  0.854  0.848
25    12      10   4220  0.520191  42     0.542  0.855  0.849
---------------------------------------------------------------
Stopping Condition 2: Improvement below threshold

Pruning Pass
--------------------------------------------
iter  bf  terms  mse   gcv    rsq    grsq
--------------------------------------------
0     -   42     0.52  0.543  0.855  0.849
1     2   41     0.52  0.542  0.855  0.849
2     41  40     0.52  0.542  0.855  0.849
3     28  39     0.52  0.541  0.855  0.849
4     39  38     0.52  0.541  0.855  0.849
5     31  37     0.52  0.540  0.855  0.849
6     5   36     0.52  0.540  0.855  0.850
7     37  35     0.52  0.539  0.855  0.850
8     33  34     0.52  0.539  0.855  0.850
9     8   33     0.52  0.539  0.855  0.850
10    4   32     0.52  0.539  0.854  0.850
11    7   31     0.53  0.542  0.853  0.849
12    40  30     0.53  0.546  0.852  0.848
13    32  29     0.53  0.550  0.851  0.847
14    38  28     0.54  0.554  0.850  0.846
15    18  27     0.54  0.558  0.849  0.844
16    21  26     0.55  0.565  0.846  0.843
17    20  25     0.55  0.568  0.845  0.842
18    25  24     0.56  0.574  0.844  0.840
19    15  23     0.57  0.582  0.841  0.838
20    35  22     0.58  0.590  0.839  0.836
21    34  21     0.58  0.595  0.838  0.834
22    27  20     0.59  0.604  0.835  0.832
23    14  19     0.60  0.614  0.832  0.829
24    24  18     0.62  0.631  0.827  0.824
25    23  17     0.63  0.642  0.824  0.821
26    11  16     0.65  0.655  0.820  0.817
27    17  15     0.66  0.665  0.817  0.815
28    16  14     0.66  0.669  0.816  0.813
29    26  13     0.68  0.692  0.810  0.807
30    19  12     0.69  0.697  0.808  0.806
31    6   11     0.69  0.700  0.807  0.805
32    29  10     0.71  0.712  0.803  0.802
33    22  9      0.72  0.731  0.798  0.796
34    36  8      0.75  0.755  0.791  0.790
35    13  7      0.78  0.785  0.783  0.781
36    12  6      0.82  0.821  0.772  0.771
37    9   5      0.93  0.938  0.740  0.739
38    10  4      1.04  1.045  0.710  0.709
39    3   3      1.23  1.237  0.656  0.655
40    30  2      2.28  2.285  0.364  0.363
41    1   1      3.59  3.589  0.000  0.000
--------------------------------------------
Selected iteration: 8

Earth Model
-------------------------------------------------------------------------
Basis Function                                     Pruned  Coefficient
-------------------------------------------------------------------------
(Intercept)                                        No      -8.78191
h(log_brine_mass-13.4422)                          No      0.248101
h(13.4422-log_brine_mass)                          Yes     None
h(log_co2_mass-9.13532)*h(13.4422-log_brine_mass)  No      -0.0227674
h(9.13532-log_co2_mass)*h(13.4422-log_brine_mass)  No      -0.00364196
h(log_co2_mass-7.51599)                            Yes     None
h(7.51599-log_co2_mass)                            No      0.371239
h(log_brine_mass-12.3743)*h(log_co2_mass-7.51599)  No      -0.00740881
h(12.3743-log_brine_mass)*h(log_co2_mass-7.51599)  No      -0.0140995
log_permh                                          No      -0.9408
h(log_brine_mass-19.3392)*log_permh                No      0.193281
h(19.3392-log_brine_mass)*log_permh                No      0.0318052
time                                               No      -0.0363488
depth*log_permh                                    No      -0.000213403
h(log_brine_mass-19.3065)                          No      1.9621
h(19.3065-log_brine_mass)                          No      0.287494
h(log_brine_mass-17.6742)*time                     No      0.0161588
h(17.6742-log_brine_mass)*time                     No      0.00107978
h(log_co2_mass-19.9841)*h(log_co2_mass-7.51599)    No      0.101039
h(19.9841-log_co2_mass)*h(log_co2_mass-7.51599)    No      -0.0277381
h(log_co2_mass-16.642)*time                        No      0.00747146
h(16.642-log_co2_mass)*time                        No      0.000861218
thick*h(log_brine_mass-13.4422)                    No      0.00195233
depth*h(13.4422-log_brine_mass)                    No      -0.000215477
depth*h(log_brine_mass-13.4422)                    No      -0.000254445
h(log_co2_mass-20.0934)*log_permh                  No      0.139156
h(20.0934-log_co2_mass)*log_permh                  No      -0.0125117
time*time                                          No      0.000269008
h(log_co2_mass-12.2104)*log_permh                  Yes     None
h(12.2104-log_co2_mass)*log_permh                  No      0.0422407
h(log_co2_mass-10.3571)*h(19.3065-log_brine_mass)  No      0.0437516
h(10.3571-log_co2_mass)*h(19.3065-log_brine_mass)  Yes     None
h(por-0.199086)*h(log_brine_mass-13.4422)          No      -533.814
h(0.199086-por)*h(log_brine_mass-13.4422)          Yes     None
thick*h(log_co2_mass-7.51599)                      No      0.00118118
thick*time                                         No      -0.000191648
h(log_co2_mass-18.8141)*h(19.3065-log_brine_mass)  No      -0.0154138
h(18.8141-log_co2_mass)*h(19.3065-log_brine_mass)  Yes     None
h(log_co2_mass-18.8381)*time                       No      -0.00874415
h(18.8381-log_co2_mass)*time                       Yes     None
h(log_brine_mass-18.3589)*time                     No      -0.0148815
h(18.3589-log_brine_mass)*time                     Yes     None
-------------------------------------------------------------------------
MSE: 0.5210, GCV: 0.5389, RSQ: 0.8548, GRSQ: 0.8498
parameters:
X[ 0 ] =  thick
X[ 1 ] =  depth
X[ 2 ] =  por
X[ 3 ] =  log_permh
X[ 4 ] =  log_aniso
X[ 5 ] =  rel_vol_frac_calcite
X[ 6 ] =  log_co2_rate
X[ 7 ] =  log_brine_rate
X[ 8 ] =  time
X[ 9 ] =  log_co2_mass
X[ 10 ] =  log_brine_mass
'''
def model(example_iterator):
    accessors = [
        lambda x: -8.78190916652946,
        lambda x: 0.248101065988521 * max(0, x[10] - 13.44217930068192),
        lambda x: -0.02276738729231208 * max(0, x[9] - 9.135323152820336) *\
            max(0, 13.44217930068192 - x[10]),
        lambda x: -0.003641958410949723 * max(0, 9.135323152820336 - x[9]) *\
            max(0, 13.44217930068192 - x[10]),
        lambda x: 0.3712393818258341 * max(0, 7.515987622785601 - x[9]),
        lambda x: -0.007408809602629637 * max(0, x[10] - 12.374329557918076) *\
            max(0, x[9] - 7.515987622785601),
        lambda x: -0.014099489032988887 * max(0, 12.374329557918076 - x[10]) *\
            max(0, x[9] - 7.515987622785601),
        lambda x: -0.9407995706205469 * x[3],
        lambda x: 0.19328058537836482 * max(0, x[10] - 19.339228572949427) * x[3],
        lambda x: 0.031805163646754016 * max(0, 19.339228572949427 - x[10]) * x[3],
        lambda x: -0.03634884766408065 * x[8],
        lambda x: -0.00021340255208243675 * x[1] * x[3],
        lambda x: 1.962102068234581 * max(0, x[10] - 19.306509899866928),
        lambda x: 0.2874938237142469 * max(0, 19.306509899866928 - x[10]),
        lambda x: 0.016158795143421504 * max(0, x[10] - 17.67415379691583) * x[8],
        lambda x: 0.0010797771628015271 * max(0, 17.67415379691583 - x[10]) * x[8],
        lambda x: 0.1010387718151641 * max(0, x[9] - 19.984065462742358) *\
            max(0, x[9] - 7.515987622785601),
        lambda x: -0.02773805919623938 * max(0, 19.984065462742358 - x[9]) *\
            max(0, x[9] - 7.515987622785601),
        lambda x: 0.007471464931459699 * max(0, x[9] - 16.641993928910754) * x[8],
        lambda x: 0.0008612183618538511 * max(0, 16.641993928910754 - x[9]) * x[8],
        lambda x: 0.0019523312400310851 * x[0] * max(0, x[10] - 13.44217930068192),
        lambda x: -0.00021547654270569205 * x[1] * max(0, 13.44217930068192 - x[10]),
        lambda x: -0.00025444491848095746 * x[1] * max(0, x[10] - 13.44217930068192),
        lambda x: 0.13915620678569005 * max(0, x[9] - 20.093386359828187) * x[3],
        lambda x: -0.012511680182614697 * max(0, 20.093386359828187 - x[9]) * x[3],
        lambda x: 0.00026900790471343083 * x[8] * x[8],
        lambda x: 0.04224071348623257 * max(0, 12.210446607942671 - x[9]) * x[3],
        lambda x: 0.04375156402379811 * max(0, x[9] - 10.357147427540205) *\
            max(0, 19.306509899866928 - x[10]),
        lambda x: -533.8136431263773 * max(0, x[2] - 0.19908597940829562) *\
            max(0, x[10] - 13.44217930068192),
        lambda x: 0.001181182429775834 * x[0] * max(0, x[9] - 7.515987622785601),
        lambda x: -0.0001916478546767214 * x[0] * x[8],
        lambda x: -0.01541381407042728 * max(0, x[9] - 18.81411425868694) *\
            max(0, 19.306509899866928 - x[10]),
        lambda x: -0.00874414842561831 * max(0, x[9] - 18.838067941182857) * x[8],
        lambda x: -0.014881495204528937 * max(0, x[10] - 18.3588777847027) * x[8]]
    for x in example_iterator:
        yield sum(accessor(x) for accessor in accessors)
